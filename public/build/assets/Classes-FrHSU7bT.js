import{r as v,c as f,o as A,K as F,g as c,d as i,e,l as C,t as d,u as P,W as D,a as z,L as K,b as j,w as I,k as S,F as k,h as L,T as U,j as $,f as V,v as q,i as G,n as J}from"./app-DOBgdSPY.js";import{_ as Q}from"./DashboardLayout-BnhVPHV2.js";import{_ as O}from"./CardSpotlight.vue_vue_type_script_setup_true_lang-BrpJXBHm.js";import"./index-DFJ3tmy6.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./sweetalert2.esm.all-BQIkj5Wb.js";const Z={class:"grid grid-cols-1 md:grid-cols-3 gap-6 p-4"},ee={class:"bg-white rounded-lg shadow p-4"},te={class:"bg-white rounded-lg shadow p-4"},se={class:"bg-white rounded-lg shadow p-4"},le={class:"grid grid-cols-1 md:grid-cols-3 gap-6 px-4 mt-6"},oe={class:"bg-white shadow p-4 rounded-lg text-center"},ae={class:"text-3xl font-bold text-mcclightblue"},ne={class:"bg-white shadow p-4 rounded-lg text-center"},ie={class:"text-3xl font-bold text-green-600"},re={__name:"AdminClasses",setup(w){const g=v(0),u=v(0),b=v([]),x=async()=>{try{const o=await z.get("/class-stats");g.value=o.data.totalClasses,u.value=o.data.totalStudents,b.value=o.data.classes.map(t=>({label:`${t.course} ${t.year} - ${t.section}`,count:t.studentCount,color:t.color,id:t.id}))}catch(o){console.error("Failed to load class stats",o)}},m=f(()=>({tooltip:{trigger:"item"},series:[{type:"pie",radius:["40%","70%"],label:{show:!1},labelLine:{show:!1},emphasis:{label:{show:!0,fontSize:16,fontWeight:"bold"}},data:b.value.reduce((o,t)=>{const s=t.label.split(" ")[0],a=o.find(y=>y.name===s);return a?a.value+=1:o.push({name:s,value:1}),o},[])}]})),p=f(()=>{const o={};b.value.forEach(s=>{const a=s.label.split(" ")[0];o[a]||(o[a]={total:0,count:0}),o[a].total+=s.count,o[a].count+=1});const t=Object.entries(o).map(([s,{total:a,count:y}])=>({name:s,value:y?(a/y).toFixed(1):0}));return{tooltip:{trigger:"axis"},xAxis:{type:"value",axisLabel:{color:"#6B7280"}},yAxis:{type:"category",data:t.map(s=>s.name),axisLabel:{color:"#374151",fontWeight:"bold"}},series:[{type:"bar",data:t.map(s=>parseFloat(s.value)),barWidth:"60%",itemStyle:{color:"#3b82f6",borderRadius:6}}]}}),_=f(()=>({tooltip:{trigger:"axis"},xAxis:{type:"category",data:["1st Year","2nd Year","3rd Year","4th Year"],axisLabel:{fontWeight:"bold",color:"#374151"}},yAxis:{type:"value",axisLabel:{color:"#6B7280"}},series:[{type:"bar",data:[1,2,3,4].map(o=>b.value.filter(t=>t.label.includes(`${o}`)).length),barWidth:"60%",itemStyle:{borderRadius:6,color:"#f97316"}}]}));return A(()=>{x()}),(o,t)=>{const s=F("v-chart");return i(),c("div",null,[e("div",Z,[e("div",ee,[t[1]||(t[1]=e("h2",{class:"text-sm md:text-lg font-semibold text-gray-700 mb-2"},"Class Count by Course",-1)),C(s,{option:m.value,class:"h-[250px]",autoresize:""},null,8,["option"])]),e("div",te,[t[2]||(t[2]=e("h2",{class:"text-sm md:text-lg font-semibold text-gray-700 mb-2"},"Average Students per Class",-1)),C(s,{option:p.value,class:"h-[250px]",autoresize:""},null,8,["option"])]),e("div",se,[t[3]||(t[3]=e("h2",{class:"text-sm md:text-lg font-semibold text-gray-700 mb-2"},"Class Count by Year Level",-1)),C(s,{option:_.value,class:"h-[250px]",autoresize:""},null,8,["option"])])]),e("div",le,[e("div",oe,[t[4]||(t[4]=e("h3",{class:"text-gray-700 font-semibold text-lg"},"Total Classes",-1)),e("p",ae,d(g.value),1)]),e("div",ne,[t[5]||(t[5]=e("h3",{class:"text-gray-700 font-semibold text-lg"},"Total Students",-1)),e("p",ie,d(u.value),1)]),C(O,{label:"View All Classes",count:g.value,iconName:"students",useSvg:!0,bgColor:"#3b82f6",gradientSize:0,class:"cursor-pointer h-[90px]",onClick:t[0]||(t[0]=a=>P(D).visit("/view-classes"))},null,8,["count"])])])}}},ce={key:0,class:"fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center"},de={class:"bg-white w-full max-w-4xl p-6 rounded-lg shadow-lg relative overflow-y-auto max-h-[90vh] animate-fade-in-up"},ue={class:"text-xl sm:text-2xl font-bold mb-4 text-mccblue"},pe={key:0,class:"flex justify-center py-4"},ve={key:1},xe={class:"overflow-x-auto rounded-lg border shadow"},be={class:"min-w-full text-xs sm:text-sm bg-white"},me={class:"px-2 sm:px-4 py-2"},ge={class:"px-2 sm:px-4 py-2"},he={class:"px-2 sm:px-4 py-2"},ye={class:"px-2 sm:px-4 py-2"},fe={class:"px-2 sm:px-4 py-2 text-center"},_e={key:0},we={__name:"TeacherStudentsInClass",props:{visible:Boolean,selectedClass:Object},emits:["close"],setup(w,{emit:g}){const u=w,b=g,x=v([]),m=v(!1),p=async()=>{if(u.selectedClass){m.value=!0;try{const t=await z.get("/students/by-class",{params:{course:u.selectedClass.course,year:u.selectedClass.year,section:u.selectedClass.section}});x.value=t.data.student}catch(t){console.error("Error fetching students:",t)}finally{m.value=!1}}},_=f(()=>[...x.value].sort((t,s)=>t.gender!==s.gender?t.gender==="Male"?-1:1:t.lname.localeCompare(s.lname))),o=()=>b("close");return K(()=>u.visible,async t=>{t&&await p()}),(t,s)=>(i(),j(U,{name:"fade"},{default:I(()=>[w.visible?(i(),c("div",ce,[e("div",de,[e("h2",ue," Students in "+d(w.selectedClass.course)+" "+d(w.selectedClass.year)+"-"+d(w.selectedClass.section),1),m.value?(i(),c("div",pe,s[0]||(s[0]=[e("svg",{class:"animate-spin h-8 w-8 text-mccblue",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})],-1)]))):(i(),c("div",ve,[e("div",xe,[e("table",be,[s[2]||(s[2]=e("thead",{class:"bg-mcclightblue text-white"},[e("tr",null,[e("th",{class:"px-2 sm:px-4 py-2"},"Student ID"),e("th",{class:"px-2 sm:px-4 py-2"},"Last Name"),e("th",{class:"px-2 sm:px-4 py-2"},"First Name"),e("th",{class:"px-2 sm:px-4 py-2"},"Middle Name"),e("th",{class:"px-2 sm:px-4 py-2 text-center"},"Gender")])],-1)),e("tbody",null,[(i(!0),c(k,null,L(_.value,a=>(i(),c("tr",{key:a.id,class:"hover:bg-gray-100"},[e("td",me,d(a.studid),1),e("td",ge,d(a.lname),1),e("td",he,d(a.fname),1),e("td",ye,d(a.mname),1),e("td",fe,d(a.gender),1)]))),128)),x.value.length===0?(i(),c("tr",_e,s[1]||(s[1]=[e("td",{colspan:"5",class:"text-center py-4"},"No students in this class.",-1)]))):S("",!0)])])])])),e("button",{onClick:o,class:"absolute top-4 right-4 text-xl text-gray-600 hover:text-red-500 transition"}," Ã— ")])])):S("",!0)]),_:1}))}},Ce=X(we,[["__scopeId","data-v-d8f6fbbe"]]),$e={class:"p-4"},ke={class:"mb-4"},Se={class:"text-gray-600 mt-1"},Le={key:0},je={key:1},ze={class:"flex flex-col md:flex-row justify-between items-center mb-4"},Be={class:"mb-2 md:mb-0"},Ae=["value"],Ne={key:0,class:"flex justify-center py-10"},Ye={key:1},Me={class:"min-w-full bg-white shadow rounded-lg overflow-hidden"},We={class:"bg-mcclightblue text-white"},Te=["onClick"],Ve={key:0},Fe={class:"py-2 px-4 font-medium text-center"},Pe={class:"py-2 px-4 text-center"},De={class:"py-2 px-4 text-center"},Ie=["onClick"],Oe={key:0},Re={class:"flex justify-between bg-mcclightblue items-center px-2 text-sm text-white select-none rounded-b-lg"},Ee={class:"font-semibold"},He={class:"font-semibold"},Ke={class:"font-semibold"},Ue={class:"flex gap-1"},qe=["disabled"],Ge=["onClick"],Je=["disabled"],Qe={key:0,class:"text-center text-gray-500 mt-10"},Xe={__name:"TeacherClasses",setup(w){const g=v([]),u=v(!0),b=v(""),x=v([{key:"classLabel",direction:"asc"}]),m=v(10),p=v(1),_=[{key:"classLabel",label:"Class"},{key:"subjectCount",label:"Subjects Handled"}],o=async()=>{try{const r=await z.get("/teacher-classes");g.value=r.data.classes}catch(r){console.error("Failed to load teacher classes:",r)}finally{u.value=!1}},t=f(()=>g.value.map(r=>({classKey:`${r.course}_${r.year}_${r.section}`,course:r.course,year:r.year,section:r.section,classLabel:`${r.course} ${r.year}-${r.section}`,subjects:r.subjects,subjectCount:r.subjects.length}))),s=f(()=>[...t.value].sort((l,n)=>{for(const h of x.value){const B=h.key,T=h.direction;if(l[B]<n[B])return T==="asc"?-1:1;if(l[B]>n[B])return T==="asc"?1:-1}return 0}).filter(l=>Object.values(l).join(" ").toLowerCase().includes(b.value.toLowerCase()))),a=f(()=>{const r=(p.value-1)*m.value;return s.value.slice(r,r+m.value)}),y=f(()=>Math.ceil(s.value.length/m.value)),M=()=>{p.value=1},R=r=>{const l=x.value.findIndex(n=>n.key===r);l!==-1?x.value[l].direction=x.value[l].direction==="asc"?"desc":"asc":x.value.push({key:r,direction:"asc"})},W=f(()=>{const r=t.value.flatMap(l=>l.subjects.map(n=>n.code));return new Set(r).size}),N=v(!1),Y=v(null),E=r=>{Y.value={course:r.course,year:r.year,section:r.section},N.value=!0},H=()=>{N.value=!1,Y.value=null};return A(()=>{o()}),(r,l)=>(i(),c(k,null,[e("div",$e,[e("div",ke,[l[6]||(l[6]=e("h1",{class:"text-2xl font-bold text-mccblue"},"Classes Overview",-1)),e("p",Se,[$(" You are handling "+d(s.value.length)+" class",1),s.value.length!==1?(i(),c("span",Le,"es")):S("",!0),$(" with "+d(W.value)+" unique subject",1),W.value!==1?(i(),c("span",je,"s")):S("",!0),l[5]||(l[5]=$(". "))])]),e("div",ze,[e("div",Be,[l[7]||(l[7]=e("label",{class:"mr-2"},"Show",-1)),V(e("select",{"onUpdate:modelValue":l[0]||(l[0]=n=>m.value=n),onChange:M,class:"border py-1 rounded"},[(i(),c(k,null,L([10,25,50,100],n=>e("option",{key:n,value:n},d(n),9,Ae)),64))],544),[[q,m.value]]),l[8]||(l[8]=e("span",{class:"ml-2"},"entries",-1))]),V(e("input",{"onUpdate:modelValue":l[1]||(l[1]=n=>b.value=n),onInput:M,type:"text",placeholder:"Search classes...",class:"border px-3 py-1 rounded w-full md:w-64"},null,544),[[G,b.value]])]),u.value?(i(),c("div",Ne,l[9]||(l[9]=[e("svg",{class:"animate-spin h-8 w-8 text-mccblue",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})],-1)]))):(i(),c("div",Ye,[e("table",Me,[e("thead",We,[e("tr",null,[(i(),c(k,null,L(_,n=>e("th",{key:n.key,class:"py-2 px-4 text-center cursor-pointer select-none",onClick:h=>R(n.key)},[$(d(n.label)+" ",1),x.value.find(h=>h.key===n.key)?(i(),c("span",Ve,d(x.value.find(h=>h.key===n.key).direction==="asc"?"â–²":"â–¼"),1)):S("",!0)],8,Te)),64)),l[10]||(l[10]=e("th",{class:"py-2 px-4 text-center"},"Actions",-1))])]),e("tbody",null,[(i(!0),c(k,null,L(a.value,n=>(i(),c("tr",{key:n.classKey,class:"hover:bg-gray-100"},[e("td",Fe,d(n.classLabel),1),e("td",Pe,[e("ul",null,[(i(!0),c(k,null,L(n.subjects,h=>(i(),c("li",{key:h.code},d(h.code)+" - "+d(h.title),1))),128))])]),e("td",De,[e("button",{class:"text-green-600 hover:underline select-none ml-2.5",onClick:h=>E(n)},"View",8,Ie)])]))),128)),a.value.length===0?(i(),c("tr",Oe,l[11]||(l[11]=[e("td",{colspan:"3",class:"text-center py-4"},"No classes found.",-1)]))):S("",!0)])]),e("div",Re,[e("div",null,[l[12]||(l[12]=$(" Showing ")),e("span",Ee,d(a.value.length?(p.value-1)*m.value+1:0),1),l[13]||(l[13]=$(" to ")),e("span",He,d((p.value-1)*m.value+a.value.length),1),l[14]||(l[14]=$(" of ")),e("span",Ke,d(s.value.length),1),l[15]||(l[15]=$(" entries "))]),e("div",Ue,[e("button",{onClick:l[2]||(l[2]=n=>x.value=[]),class:"text-sm hover:bg-mccblue px-2 py-1 rounded transition"}," Clear Sorting "),e("button",{onClick:l[3]||(l[3]=n=>p.value--),disabled:p.value===1,class:"px-3 py-1 rounded disabled:opacity-50 disabled:hover:bg-mcclightblue hover:bg-mccblue"}," Prev ",8,qe),(i(!0),c(k,null,L(y.value,n=>(i(),c("button",{key:n,onClick:h=>p.value=n,class:J(["px-3 py-1 rounded",p.value===n?"bg-white text-mccblue font-bold":"hover:bg-mccblue transition"])},d(n),11,Ge))),128)),e("button",{onClick:l[4]||(l[4]=n=>p.value++),disabled:p.value===y.value,class:"px-3 py-1 rounded disabled:opacity-50 disabled:hover:bg-mcclightblue hover:bg-mccblue transition"}," Next ",8,Je)])]),s.value.length===0?(i(),c("div",Qe,l[16]||(l[16]=[e("div",{class:"text-6xl mb-2"},"ðŸ“š",-1),e("p",{class:"text-lg"},"No classes assigned to you yet.",-1)]))):S("",!0)]))]),C(Ce,{visible:N.value,selectedClass:Y.value,onClose:H},null,8,["visible","selectedClass"])],64))}},Ze={class:"grid grid-cols-1 md:grid-cols-3 gap-6 p-4"},et={class:"bg-white rounded-lg shadow p-4"},tt={class:"bg-white rounded-lg shadow p-4"},st={class:"bg-white rounded-lg shadow p-4"},lt={class:"grid grid-cols-1 md:grid-cols-3 gap-6 px-4 mt-6"},ot={class:"bg-white shadow p-4 rounded-lg text-center"},at={class:"text-3xl font-bold text-mcclightblue"},nt={class:"bg-white shadow p-4 rounded-lg text-center"},it={class:"text-3xl font-bold text-green-600"},rt={__name:"RegistrarClasses",setup(w){const g=v(0),u=v(0),b=v([]),x=async()=>{try{const o=await z.get("/class-stats");g.value=o.data.totalClasses,u.value=o.data.totalStudents,b.value=o.data.classes.map(t=>({label:`${t.course} ${t.year} - ${t.section}`,count:t.studentCount,color:t.color,id:t.id}))}catch(o){console.error("Failed to load class stats",o)}},m=f(()=>({tooltip:{trigger:"item"},series:[{type:"pie",radius:["40%","70%"],label:{show:!1},labelLine:{show:!1},emphasis:{label:{show:!0,fontSize:16,fontWeight:"bold"}},data:b.value.reduce((o,t)=>{const s=t.label.split(" ")[0],a=o.find(y=>y.name===s);return a?a.value+=1:o.push({name:s,value:1}),o},[])}]})),p=f(()=>{const o={};b.value.forEach(s=>{const a=s.label.split(" ")[0];o[a]||(o[a]={total:0,count:0}),o[a].total+=s.count,o[a].count+=1});const t=Object.entries(o).map(([s,{total:a,count:y}])=>({name:s,value:y?(a/y).toFixed(1):0}));return{tooltip:{trigger:"axis"},xAxis:{type:"value",axisLabel:{color:"#6B7280"}},yAxis:{type:"category",data:t.map(s=>s.name),axisLabel:{color:"#374151",fontWeight:"bold"}},series:[{type:"bar",data:t.map(s=>parseFloat(s.value)),barWidth:"60%",itemStyle:{color:"#3b82f6",borderRadius:6}}]}}),_=f(()=>({tooltip:{trigger:"axis"},xAxis:{type:"category",data:["1st Year","2nd Year","3rd Year","4th Year"],axisLabel:{fontWeight:"bold",color:"#374151"}},yAxis:{type:"value",axisLabel:{color:"#6B7280"}},series:[{type:"bar",data:[1,2,3,4].map(o=>b.value.filter(t=>t.label.includes(`${o}`)).length),barWidth:"60%",itemStyle:{borderRadius:6,color:"#f97316"}}]}));return A(()=>{x()}),(o,t)=>{const s=F("v-chart");return i(),c("div",null,[e("div",Ze,[e("div",et,[t[1]||(t[1]=e("h2",{class:"text-sm md:text-lg font-semibold text-gray-700 mb-2"},"Class Count by Course",-1)),C(s,{option:m.value,class:"h-[250px]",autoresize:""},null,8,["option"])]),e("div",tt,[t[2]||(t[2]=e("h2",{class:"text-sm md:text-lg font-semibold text-gray-700 mb-2"},"Average Students per Class",-1)),C(s,{option:p.value,class:"h-[250px]",autoresize:""},null,8,["option"])]),e("div",st,[t[3]||(t[3]=e("h2",{class:"text-sm md:text-lg font-semibold text-gray-700 mb-2"},"Class Count by Year Level",-1)),C(s,{option:_.value,class:"h-[250px]",autoresize:""},null,8,["option"])])]),e("div",lt,[e("div",ot,[t[4]||(t[4]=e("h3",{class:"text-gray-700 font-semibold text-lg"},"Total Classes",-1)),e("p",at,d(g.value),1)]),e("div",nt,[t[5]||(t[5]=e("h3",{class:"text-gray-700 font-semibold text-lg"},"Total Students",-1)),e("p",it,d(u.value),1)]),C(O,{label:"View All Classes",count:g.value,iconName:"students",useSvg:!0,bgColor:"#3b82f6",gradientSize:0,class:"cursor-pointer h-[90px]",onClick:t[0]||(t[0]=a=>P(D).visit("/view-classes"))},null,8,["count"])])])}}},ct={key:0,class:"flex justify-center py-10"},dt={key:1},ut={key:3,class:"text-center text-red-500"},ht={__name:"Classes",setup(w){const g=v(""),u=v(""),b=v(""),x=v(!0),m=async()=>{try{const p=await z.get("/session");g.value=p.data.fullname,u.value=p.data.level,b.value=p.data.username,(!g.value||!u.value)&&(window.location.href="/")}catch{window.location.href="/"}finally{x.value=!1}};return A(()=>{m()}),(p,_)=>(i(),j(Q,{fullname:g.value,userLevel:u.value,title:u.value==="teacher"?"My Classes":"Classes",class:"animate-slide-in-top"},{default:I(()=>[x.value?(i(),c("div",ct,_[0]||(_[0]=[e("svg",{class:"animate-spin h-8 w-8 text-mccblue",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})],-1)]))):(i(),c("div",dt,[u.value==="admin"?(i(),j(re,{key:0})):u.value==="teacher"?(i(),j(Xe,{key:1})):u.value==="registrar"?(i(),j(rt,{key:2})):(i(),c("div",ut," Unknown user level: "+d(u.value),1))]))]),_:1},8,["fullname","userLevel","title"]))}};export{ht as default};
