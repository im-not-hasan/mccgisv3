import{r as b,c as k,o as A,K as F,g as i,d as n,e,l as H,f as M,k as x,a2 as I,F as w,h as j,b as P,t as r,a as N,W as O,i as S,v as D,j as U,n as q,w as W}from"./app-8qenG6k4.js";import{_ as G}from"./DashboardLayout-yVP8rKql.js";import{_ as K}from"./CardSpotlight.vue_vue_type_script_setup_true_lang-CygHcJIN.js";import"./index-COuBSjwV.js";import"./sweetalert2.esm.all-BQIkj5Wb.js";const R={class:"flex flex-col md:flex-row gap-6 p-1"},Y={class:"flex-1 bg-white rounded-lg shadow p-4 flex flex-col justify-center"},J={class:"flex justify-between items-center mb-2"},Q={class:"space-x-1 md:space-x-4 text-sm text-gray-700"},X={class:"flex flex-col justify-between space-y-2"},Z={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6 px-4"},ee={class:"bg-white shadow p-4 rounded-lg text-center"},te={class:"text-3xl font-bold text-mcclightblue"},se={class:"bg-white shadow p-4 rounded-lg text-center"},le={class:"text-3xl font-bold text-green-600"},oe={__name:"AdminSubjects",setup(z){const h=b({}),p=b({total:0,active:0}),f=b("active"),u=b([{name:"BSIT",label:"BSIT",count:0,color:"#dc2626"},{name:"BSBA",label:"BSBA-FM",count:0,color:"#16a34a"},{name:"BSHM",label:"BSHM",count:0,color:"#ea580c"},{name:"BSED",label:"BSED Filipino",count:0,color:"#1e3a8a"},{name:"BEED",label:"BEED",count:0,color:"#0ea5e9"}]),v=async()=>{try{const y=await N.get(`/subject-counts?mode=${f.value}`);h.value=y.data.byCourse,p.value={total:y.data.totals.total,active:y.data.totals.active},u.value=u.value.map(d=>({...d,count:h.value[d.name]||0}))}catch(y){console.error("Error fetching subject counts:",y)}},c=y=>{O.visit(`/subjects/${y}`)},C=k(()=>({tooltip:{trigger:"axis"},xAxis:{type:"category",data:u.value.map(y=>y.label),axisLabel:{fontWeight:"bold",color:"#374151"}},yAxis:{type:"value",axisLabel:{color:"#6B7280"}},series:[{data:u.value.map(y=>y.count),type:"bar",itemStyle:{borderRadius:6,color:y=>u.value[y.dataIndex].color},barWidth:"50%"}],grid:{left:"5%",right:"5%",bottom:"10%",top:"10%",containLabel:!0}}));return A(()=>{v()}),(y,d)=>{const $=F("v-chart");return n(),i(w,null,[e("div",R,[e("div",Y,[e("div",J,[d[4]||(d[4]=e("h2",{class:"text-sm md:text-lg font-semibold text-gray-700"},"Subject Count per Course",-1)),e("div",Q,[e("label",null,[M(e("input",{type:"radio",class:"focus:ring-[0%] cursor-pointer",value:"active","onUpdate:modelValue":d[0]||(d[0]=m=>f.value=m),onChange:v},null,544),[[I,f.value]]),d[2]||(d[2]=x(" Active"))]),e("label",null,[M(e("input",{type:"radio",class:"focus:ring-[0%] cursor-pointer",value:"total","onUpdate:modelValue":d[1]||(d[1]=m=>f.value=m),onChange:v},null,544),[[I,f.value]]),d[3]||(d[3]=x(" Total"))])])]),H($,{option:C.value,autoresize:"",class:"h-[390px]"},null,8,["option"])]),e("div",X,[(n(!0),i(w,null,j(u.value,m=>(n(),P(K,{key:m.label,label:m.label,count:m.count,iconName:"subjects",useSvg:!0,bgColor:m.color,gradientSize:0,class:"cursor-pointer md:w-[300px] h-[90px]",onClick:B=>c(m.name)},null,8,["label","count","bgColor","onClick"]))),128))])]),e("div",Z,[e("div",ee,[d[5]||(d[5]=e("h3",{class:"text-gray-700 font-semibold text-lg"},"Total Subjects (All Semesters)",-1)),e("p",te,r(p.value.total),1)]),e("div",se,[d[6]||(d[6]=e("h3",{class:"text-gray-700 font-semibold text-lg"},"Active Subjects (Current Semester)",-1)),e("p",le,r(p.value.active),1)])])],64)}}},ne={class:"p-4"},ae={class:"mb-4"},ie={class:"text-gray-600 mt-1"},ce={key:0},re={key:1},ue={class:"flex flex-col md:flex-row justify-between items-center mb-4"},de={class:"mb-2 md:mb-0"},ve=["value"],be={key:0,class:"flex justify-center py-10"},pe={key:1},ye={class:"min-w-full bg-white shadow rounded-lg overflow-hidden"},me={class:"bg-mcclightblue text-white"},xe=["onClick"],fe={key:0},ge={class:"py-2 px-4 font-medium text-center"},he={class:"py-2 px-4 text-center"},_e={class:"py-2 px-4 text-center"},ke={class:"text-center"},$e=["onClick"],we={key:0},je={class:"flex justify-between bg-mcclightblue items-center px-2 text-sm text-white select-none rounded-b-lg"},Ce={class:"font-semibold"},Se={class:"font-semibold"},Be={class:"font-semibold"},Le={class:"flex gap-1"},Me=["disabled"],Pe=["onClick"],Te=["disabled"],Ve={__name:"TeacherSubjects",setup(z){const h=b([]),p=b(!0),f=b(""),u=b([{key:"title",direction:"asc"}]),v=b(10),c=b(1),C=[{key:"code",label:"Subject Code"},{key:"title",label:"Subject Title"},{key:"classLabel",label:"Class"}],y=async()=>{try{const o=await N.get("/teacher-classes");h.value=o.data.classes}catch(o){console.error("Failed to load teacher classes:",o)}finally{p.value=!1}},d=k(()=>{const o=[];return h.value.forEach(t=>{t.subjects.forEach(s=>{o.push({code:s.code,title:s.title,course:t.course,year:t.year,section:t.section,classLabel:`${t.course} ${t.year}-${t.section}`})})}),o}),$=k(()=>[...d.value].sort((t,s)=>{for(const _ of u.value){const L=_.key,E=_.direction;if(t[L]<s[L])return E==="asc"?-1:1;if(t[L]>s[L])return E==="asc"?1:-1}return 0}).filter(t=>Object.values(t).join(" ").toLowerCase().includes(f.value.toLowerCase()))),m=k(()=>{const o=(c.value-1)*v.value;return $.value.slice(o,o+v.value)}),B=k(()=>Math.ceil($.value.length/v.value)),T=()=>{c.value=1},V=o=>{const t=u.value.findIndex(s=>s.key===o);t!==-1?u.value[t].direction=u.value[t].direction==="asc"?"desc":"asc":u.value.push({key:o,direction:"asc"})},g=k(()=>h.value.map(o=>({classKey:`${o.course}_${o.year}_${o.section}`,course:o.course,year:o.year,section:o.section,classLabel:`${o.course} ${o.year}-${o.section}`,subjects:o.subjects}))),l=k(()=>new Set(d.value.map(t=>t.code)).size),a=o=>{const{code:t,course:s,year:_,section:L}=o,E=`/grades-entry?subject=${t}&course=${s}&year=${_}&section=${L}`;window.open(E,"_blank")};return A(()=>{y()}),(o,t)=>(n(),i("div",ne,[e("div",ae,[t[6]||(t[6]=e("h1",{class:"text-2xl font-bold text-mccblue"},"Subjects Overview",-1)),e("p",ie,[x(" You are handling "+r(l.value)+" unique subject",1),l.value!==1?(n(),i("span",ce,"s")):S("",!0),x(" across "+r(g.value.length)+" class",1),g.value.length!==1?(n(),i("span",re,"es")):S("",!0),t[5]||(t[5]=x(". "))])]),e("div",ue,[e("div",de,[t[7]||(t[7]=e("label",{class:"mr-2"},"Show",-1)),M(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>v.value=s),onChange:T,class:"border py-1 rounded"},[(n(),i(w,null,j([10,25,50,100],s=>e("option",{key:s,value:s},r(s),9,ve)),64))],544),[[D,v.value]]),t[8]||(t[8]=e("span",{class:"ml-2"},"entries",-1))]),M(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>f.value=s),onInput:T,type:"text",placeholder:"Search subjects...",class:"border px-3 py-1 rounded w-full md:w-64"},null,544),[[U,f.value]])]),p.value?(n(),i("div",be,t[9]||(t[9]=[e("svg",{class:"animate-spin h-8 w-8 text-mccblue",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})],-1)]))):(n(),i("div",pe,[e("table",ye,[e("thead",me,[e("tr",null,[(n(),i(w,null,j(C,s=>e("th",{key:s.key,class:"py-2 px-4 text-center cursor-pointer select-none",onClick:_=>V(s.key)},[x(r(s.label)+" ",1),u.value.find(_=>_.key===s.key)?(n(),i("span",fe,r(u.value.find(_=>_.key===s.key).direction==="asc"?"▲":"▼"),1)):S("",!0)],8,xe)),64)),t[10]||(t[10]=e("th",{class:"py-2 px-4 text-center"},"Actions",-1))])]),e("tbody",null,[(n(!0),i(w,null,j(m.value,s=>(n(),i("tr",{key:`${s.code}_${s.course}_${s.year}_${s.section}`,class:"hover:bg-gray-100"},[e("td",ge,r(s.code),1),e("td",he,r(s.title),1),e("td",_e,r(s.course)+" "+r(s.year)+"-"+r(s.section),1),e("td",ke,[e("button",{class:"text-green-600 hover:underline select-none",onClick:_=>a(s)}," View Grades ",8,$e)])]))),128)),m.value.length===0?(n(),i("tr",we,t[11]||(t[11]=[e("td",{colspan:"4",class:"text-center py-4"},"No subjects found.",-1)]))):S("",!0)])]),e("div",je,[e("div",null,[t[12]||(t[12]=x(" Showing ")),e("span",Ce,r(m.value.length?(c.value-1)*v.value+1:0),1),t[13]||(t[13]=x(" to ")),e("span",Se,r((c.value-1)*v.value+m.value.length),1),t[14]||(t[14]=x(" of ")),e("span",Be,r($.value.length),1),t[15]||(t[15]=x(" entries "))]),e("div",Le,[e("button",{onClick:t[2]||(t[2]=s=>u.value=[]),class:"text-sm hover:bg-mccblue px-2 py-1 rounded transition"}," Clear Sorting "),e("button",{onClick:t[3]||(t[3]=s=>c.value--),disabled:c.value===1,class:"px-3 py-1 rounded disabled:opacity-50 disabled:hover:bg-mcclightblue hover:bg-mccblue"}," Prev ",8,Me),(n(!0),i(w,null,j(B.value,s=>(n(),i("button",{key:s,onClick:_=>c.value=s,class:q(["px-3 py-1 rounded",c.value===s?"bg-white text-mccblue font-bold":"hover:bg-mccblue transition"])},r(s),11,Pe))),128)),e("button",{onClick:t[4]||(t[4]=s=>c.value++),disabled:c.value===B.value,class:"px-3 py-1 rounded disabled:opacity-50 disabled:hover:bg-mcclightblue hover:bg-mccblue transition"}," Next ",8,Te)])])]))]))}},Ee={class:"p-4"},Ae={class:"mb-4"},Ne={class:"text-gray-600 mt-1"},ze={key:0},Ie={class:"flex flex-col md:flex-row justify-between items-center mb-4"},De={class:"mb-2 md:mb-0"},Ue=["value"],qe={key:0,class:"flex justify-center py-10"},Fe={key:1},He={class:"min-w-full bg-white shadow rounded-lg overflow-hidden"},Oe={class:"bg-mcclightblue text-white"},We=["onClick"],Ge={key:0},Ke={class:"py-2 px-4 font-medium text-center"},Re={class:"py-2 px-4 text-center"},Ye={class:"py-2 px-4 text-center"},Je={key:0},Qe={class:"flex justify-between bg-mcclightblue items-center px-2 text-sm text-white select-none rounded-b-lg"},Xe={class:"font-semibold"},Ze={class:"font-semibold"},et={class:"font-semibold"},tt={class:"flex gap-1"},st=["disabled"],lt=["onClick"],ot=["disabled"],nt={__name:"StudentSubjects",setup(z){const h=b([]),p=b(!0),f=b(""),u=b([{key:"title",direction:"asc"}]),v=b(10),c=b(1),C=[{key:"code",label:"Subject Code"},{key:"title",label:"Subject Title"},{key:"instructor",label:"Instructor"}],y=async()=>{try{const g=await N.get("/student-subjects");h.value=g.data.subjects}catch(g){console.error("Failed to load student subjects:",g)}finally{p.value=!1}},d=k(()=>[...h.value].sort((l,a)=>{for(const o of u.value){const t=o.key,s=o.direction;if(l[t]<a[t])return s==="asc"?-1:1;if(l[t]>a[t])return s==="asc"?1:-1}return 0}).filter(l=>Object.values(l).join(" ").toLowerCase().includes(f.value.toLowerCase()))),$=k(()=>{const g=(c.value-1)*v.value;return d.value.slice(g,g+v.value)}),m=k(()=>Math.ceil(d.value.length/v.value)),B=()=>{c.value=1},T=g=>{const l=u.value.findIndex(a=>a.key===g);l!==-1?u.value[l].direction=u.value[l].direction==="asc"?"desc":"asc":u.value.push({key:g,direction:"asc"})},V=k(()=>new Set(h.value.map(l=>l.code)).size);return A(()=>{y()}),(g,l)=>(n(),i("div",Ee,[e("div",Ae,[l[6]||(l[6]=e("h1",{class:"text-2xl font-bold text-mccblue"},"My Subjects & Grades",-1)),e("p",Ne,[x(" You are enrolled in "+r(V.value)+" unique subject",1),V.value!==1?(n(),i("span",ze,"s")):S("",!0),l[5]||(l[5]=x(" this semester. "))])]),e("div",Ie,[e("div",De,[l[7]||(l[7]=e("label",{class:"mr-2"},"Show",-1)),M(e("select",{"onUpdate:modelValue":l[0]||(l[0]=a=>v.value=a),onChange:B,class:"border py-1 rounded"},[(n(),i(w,null,j([10,25,50,100],a=>e("option",{key:a,value:a},r(a),9,Ue)),64))],544),[[D,v.value]]),l[8]||(l[8]=e("span",{class:"ml-2"},"entries",-1))]),M(e("input",{"onUpdate:modelValue":l[1]||(l[1]=a=>f.value=a),onInput:B,type:"text",placeholder:"Search subjects...",class:"border px-3 py-1 rounded w-full md:w-64"},null,544),[[U,f.value]])]),p.value?(n(),i("div",qe,l[9]||(l[9]=[e("svg",{class:"animate-spin h-8 w-8 text-mccblue",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})],-1)]))):(n(),i("div",Fe,[e("table",He,[e("thead",Oe,[e("tr",null,[(n(),i(w,null,j(C,a=>e("th",{key:a.key,class:"py-2 px-4 text-center cursor-pointer select-none",onClick:o=>T(a.key)},[x(r(a.label)+" ",1),u.value.find(o=>o.key===a.key)?(n(),i("span",Ge,r(u.value.find(o=>o.key===a.key).direction==="asc"?"▲":"▼"),1)):S("",!0)],8,We)),64))])]),e("tbody",null,[(n(!0),i(w,null,j($.value,a=>(n(),i("tr",{key:a.code,class:"hover:bg-gray-100"},[e("td",Ke,r(a.code),1),e("td",Re,r(a.title),1),e("td",Ye,r(a.instructor),1)]))),128)),$.value.length===0?(n(),i("tr",Je,l[10]||(l[10]=[e("td",{colspan:"3",class:"text-center py-4"},"No subjects found.",-1)]))):S("",!0)])]),e("div",Qe,[e("div",null,[l[11]||(l[11]=x(" Showing ")),e("span",Xe,r($.value.length?(c.value-1)*v.value+1:0),1),l[12]||(l[12]=x(" to ")),e("span",Ze,r((c.value-1)*v.value+$.value.length),1),l[13]||(l[13]=x(" of ")),e("span",et,r(d.value.length),1),l[14]||(l[14]=x(" entries "))]),e("div",tt,[e("button",{onClick:l[2]||(l[2]=a=>u.value=[]),class:"text-sm hover:bg-mccblue px-2 py-1 rounded transition"}," Clear Sorting "),e("button",{onClick:l[3]||(l[3]=a=>c.value--),disabled:c.value===1,class:"px-3 py-1 rounded disabled:opacity-50 disabled:hover:bg-mcclightblue hover:bg-mccblue"}," Prev ",8,st),(n(!0),i(w,null,j(m.value,a=>(n(),i("button",{key:a,onClick:o=>c.value=a,class:q(["px-3 py-1 rounded",c.value===a?"bg-white text-mccblue font-bold":"hover:bg-mccblue transition"])},r(a),11,lt))),128)),e("button",{onClick:l[4]||(l[4]=a=>c.value++),disabled:c.value===m.value,class:"px-3 py-1 rounded disabled:opacity-50 disabled:hover:bg-mcclightblue hover:bg-mccblue transition"}," Next ",8,ot)])])]))]))}},at={key:0,class:"flex justify-center py-10"},it={key:1},ct={key:3,class:"text-center text-red-500"},pt={__name:"Subjects",setup(z){const h=b(""),p=b(""),f=b(""),u=b(!0),v=async()=>{try{const c=await N.get("/session");h.value=c.data.fullname,p.value=c.data.level,f.value=c.data.username,(!h.value||!p.value)&&(window.location.href="/")}catch{window.location.href="/"}finally{u.value=!1}};return A(()=>{v()}),(c,C)=>(n(),P(G,{fullname:h.value,userLevel:p.value,title:p.value==="teacher"||p.value==="student"?"My Subjects":"Subjects",class:"animate-slide-in-top"},{default:W(()=>[u.value?(n(),i("div",at,C[0]||(C[0]=[e("svg",{class:"animate-spin h-8 w-8 text-mccblue",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})],-1)]))):(n(),i("div",it,[p.value==="admin"?(n(),P(oe,{key:0})):p.value==="teacher"?(n(),P(Ve,{key:1})):p.value==="student"?(n(),P(nt,{key:2})):(n(),i("div",ct," Unknown user level: "+r(p.value),1))]))]),_:1},8,["fullname","userLevel","title"]))}};export{pt as default};
