import{r as v,L as ne,g as c,d as u,e,b as le,l as Q,w as se,i as q,t as m,p as re,f as k,j as L,v as W,T as ae,M as ue,a as j,n as ie,F as A,h as F,z as ce,N as me,c as ee,o as pe,u as te,k as G}from"./app-8qenG6k4.js";import{S as f}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{_ as ve}from"./DashboardLayout-yVP8rKql.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";const be={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},fe={class:"bg-white w-full max-w-3xl p-6 rounded-xl shadow-lg relative animate-fade-in-up"},ge={class:"text-xl font-bold mb-4 text-mccblue select-none"},xe={__name:"InstructorForm",props:{course:String,editMode:Boolean,instructorToEdit:Object},emits:["submitted","cancelEdit"],setup(V,{emit:H}){const y=H,x=V,C=v(!1),$=x.course,r=v({teachid:"",fname:"",mname:"",lname:"",sex:"",age:"",email:"",phone:"",department:$}),E=()=>{r.value={teachid:"",fname:"",mname:"",lname:"",sex:"",age:"",email:"",phone:"",department:$}},U=()=>{x.editMode||(E(),C.value=!0)},S=()=>{C.value=!1,E(),y("cancelEdit")};ne(()=>x.instructorToEdit,l=>{x.editMode&&l&&(r.value={teachid:l.teachid,fname:l.fname,mname:l.mname,lname:l.lname,sex:l.sex,age:l.age,email:l.email,phone:l.phone,department:$},C.value=!0)},{immediate:!0});const i=()=>{r.value.phone=r.value.phone.replace(/\D/g,"")},h=async l=>{try{return(await j.get(`/api/instructors/check/${l}`)).data.exists}catch(t){return console.error("Failed to check teachid:",t),!1}},M=()=>{let l=(r.value.teachid||"").toUpperCase();if(!l){r.value.teachid="";return}if(l.startsWith("EMP")&&(l=l.slice(3)),l=l.replace(/\D/g,""),!l){r.value.teachid="";return}l.length>8&&(l=l.slice(0,8));let t=l;l.length>4&&(t=l.slice(0,4)+"-"+l.slice(4)),r.value.teachid="EMP"+t},T=async()=>{var l;if(!x.editMode&&await h(r.value.teachid)){f.fire("Error","Teacher ID already exists. Please use a unique ID.","error");return}try{x.editMode&&((l=x.instructorToEdit)!=null&&l.id)?(await j.put(`/instructors/${x.instructorToEdit.id}`,r.value),f.fire({icon:"success",title:"Instructor Updated",toast:!0,position:"top-end",timer:2e3,showConfirmButton:!1})):(await j.post("/instructors",r.value),f.fire({icon:"success",title:"Instructor Added",toast:!0,position:"top-end",timer:2e3,showConfirmButton:!1})),E(),C.value=!1,y("submitted")}catch(t){f.fire("Error","Could not save instructor","error"),console.error("Instructor save error:",t)}};return(l,t)=>(u(),c("div",null,[e("button",{onClick:U,class:"bg-mccblue hover:bg-mccdarkblue text-white px-4 py-2 rounded-lg shadow-md transition"}," + Add Instructor "),(u(),le(ue,{to:"body"},[Q(ae,{name:"fade"},{default:se(()=>[C.value?(u(),c("div",be,[e("div",fe,[e("h2",ge,m(V.editMode?"Edit Instructor":"Add New Instructor"),1),e("form",{onSubmit:re(T,["prevent"]),class:"grid grid-cols-1 md:grid-cols-2 gap-4"},[e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1 select-none"},"Teacher ID",-1)),k(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=b=>r.value.teachid=b),onInput:M,placeholder:"e.g. EMP2000-1234",maxlength:"12",class:"peer w-full rounded-md border border-gray-300 bg-white text-gray-800 px-3 py-2 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-mccblue focus:border-mccblue transition",required:""},null,544),[[L,r.value.teachid]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1 select-none"},"First Name",-1)),k(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=b=>r.value.fname=b),placeholder:"e.g. Juan",class:"peer w-full rounded-md border border-gray-300 bg-white text-gray-800 px-3 py-2 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-mccblue focus:border-mccblue transition",required:""},null,512),[[L,r.value.fname]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1 select-none"},"Middle Name",-1)),k(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=b=>r.value.mname=b),placeholder:"Leave blank if N/A",class:"peer w-full rounded-md border border-gray-300 bg-white text-gray-800 px-3 py-2 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-mccblue focus:border-mccblue transition"},null,512),[[L,r.value.mname]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1 select-none"},"Last Name",-1)),k(e("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=b=>r.value.lname=b),placeholder:"e.g. Dela Cruz",class:"peer w-full rounded-md border border-gray-300 bg-white text-gray-800 px-3 py-2 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-mccblue focus:border-mccblue transition",required:""},null,512),[[L,r.value.lname]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1 select-none"},"Gender",-1)),k(e("select",{"onUpdate:modelValue":t[4]||(t[4]=b=>r.value.sex=b),class:"peer w-full rounded-md border border-gray-300 bg-white text-gray-800 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-mccblue focus:border-mccblue transition",required:""},t[12]||(t[12]=[e("option",{value:"",disabled:""},"Select gender",-1),e("option",{value:"Male"},"Male",-1),e("option",{value:"Female"},"Female",-1)]),512),[[W,r.value.sex]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1 select-none"},"Age",-1)),k(e("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=b=>r.value.age=b),min:"18",class:"peer w-full rounded-md border border-gray-300 bg-white text-gray-800 px-3 py-2 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-mccblue focus:border-mccblue transition"},null,512),[[L,r.value.age]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1 select-none"},"Email",-1)),k(e("input",{type:"email","onUpdate:modelValue":t[6]||(t[6]=b=>r.value.email=b),placeholder:"e.g. juandelacruz@example.com",class:"peer w-full rounded-md border border-gray-300 bg-white text-gray-800 px-3 py-2 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-mccblue focus:border-mccblue transition"},null,512),[[L,r.value.email]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1 select-none"},"Phone",-1)),k(e("input",{"onUpdate:modelValue":t[7]||(t[7]=b=>r.value.phone=b),onInput:i,placeholder:"e.g. 09123456789",maxlength:"11",class:"peer w-full rounded-md border border-gray-300 bg-white text-gray-800 px-3 py-2 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-mccblue focus:border-mccblue transition"},null,544),[[L,r.value.phone]])]),e("div",{class:"md:col-span-2 flex justify-end gap-4 pt-4"},[e("button",{type:"button",onClick:S,class:"text-gray-500 hover:text-red-500 transition"}," Cancel "),t[17]||(t[17]=e("button",{type:"submit",class:"bg-mccblue hover:bg-mccdarkblue text-white px-4 py-2 rounded-md transition"}," Save ",-1))])],32),e("button",{onClick:S,class:"absolute top-4 right-4 text-gray-500 text-2xl hover:text-red-500 transition"}," × ")])])):q("",!0)]),_:1})]))]))}},ye=de(xe,[["__scopeId","data-v-e11b0ea2"]]),he={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},we={class:"bg-white w-full max-w-3xl p-6 rounded-xl shadow-lg relative animate-fade-in-up"},ke={class:"text-xl font-bold mb-4 text-mccblue select-none"},Ce={class:"flex justify-end mb-2"},$e={key:0,class:"flex justify-center py-4"},Ee={key:1,class:"min-w-full border border-gray-300 rounded"},Se={class:"px-4 py-2"},_e={class:"px-4 py-2"},Ie={class:"px-4 py-2"},je={class:"px-4 py-2"},Be=["onClick"],Me={key:0},Te={class:"relative"},Le={key:0,class:"absolute z-10 w-full bg-white border border-gray-300 rounded-md mt-1 max-h-40 overflow-y-auto"},Ae=["onClick"],Fe={class:"grid grid-cols-3 gap-2"},Ne={__name:"AssignmentForm",props:{instructor:Object,course:String},setup(V,{expose:H}){var Y;const y=V,x=v(!1),C=v(!1),$=v(!1),r=v([]),E=v([]),U=["BSIT","BSBA","BSHM","BSED","BEED"],S=["North","East","West","South","Northeast","Northwest","Southeast","Southwest","Nihonggo","Mandarin","German","Spanish","French"],i=v({teacher_id:((Y=y.instructor)==null?void 0:Y.id)||"",subject_input:"",subject_id:"",course:"",year:"",section:""}),h=async()=>{try{const d=await j.get("/api/allsubjects");r.value=d.data}catch(d){console.error("Failed to load subjects",d)}},M=v(""),T=v([]),l=()=>{const d=M.value.toLowerCase();T.value=r.value.filter(o=>o.title.toLowerCase().includes(d))},t=d=>{i.value.subject_id=d.id,i.value.subject_input=d.title,i.value.course=d.course,i.value.year=d.year,M.value=d.title,T.value=[]},b=async()=>{var d;if((d=y.instructor)!=null&&d.id)try{const o=await j.get(`/api/instructors/${y.instructor.id}/assignments`);E.value=o.data}catch(o){console.error("Failed to load assignments",o)}finally{x.value=!1}},J=async d=>{if((await f.fire({title:"Are you sure?",text:"This will remove the assigned subject.",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes"})).isConfirmed)try{await j.delete(`/instructors/${y.instructor.id}/assignments/${d}`),f.fire({icon:"success",title:"Assignment removed.",toast:!0,position:"top-end",timer:2e3,showConfirmButton:!1}),b()}catch(a){console.error(a),f.fire("Error","Could not delete assignment","error")}},K=async()=>{C.value=!0,E.value=[],x.value=!0,await ce(),h(),b()},X=()=>{C.value=!1,$.value=!1,E.value=[],D()},N=()=>{$.value=!$.value,$.value||D()},D=()=>{i.value.subject_input="",i.value.subject_id="",i.value.course="",i.value.year="",i.value.section="",M.value="",T.value=[]};ne(()=>y.instructor,d=>{d&&d.id&&(console.log("View subjects clicked:"),console.log("instructor id:",d.id),console.log("instructor course:",y.course),K())},{immediate:!0});const O=async()=>{if(!i.value.subject_id){f.fire("Error","Please select a subject from the list.","error");return}try{await j.post(`/instructors/${y.instructor.id}/assign-subject`,{subject_id:i.value.subject_id,course:i.value.course,year:i.value.year,section:i.value.section}),f.fire({icon:"success",title:"Assignment saved",toast:!0,position:"top-end",timer:2e3,showConfirmButton:!1}),b(),D()}catch(d){console.error(d);let o="Could not save assignment";d.response&&d.response.data&&d.response.data.message&&(o=d.response.data.message),f.fire("Error",o,"error")}};return H({openModal:K}),(d,o)=>(u(),c("div",null,[Q(ae,{name:"fade"},{default:se(()=>[C.value?(u(),c("div",he,[e("div",we,[e("h2",ke,m(V.instructor.fname)+" "+m(V.instructor.lname)+" – Assigned Subjects & Classes ",1),e("div",Ce,[e("button",{onClick:N,class:"bg-mccblue hover:bg-mccdarkblue text-white px-3 py-1 rounded-md transition mr-[20px] mt-[-45px] mb-4"},m($.value?"Cancel":"+ Assign Subject"),1)]),e("div",{class:ie(["min-w-full bg-white rounded mb-4 overflow-y-auto",E.value.length>5?"max-h-64":""])},[x.value?(u(),c("div",$e,o[4]||(o[4]=[e("svg",{class:"animate-spin h-8 w-8 text-mccblue",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})],-1)]))):(u(),c("table",Ee,[o[6]||(o[6]=e("thead",{class:"bg-mcclightblue text-white"},[e("tr",null,[e("th",{class:"px-4 py-2"},"Subject"),e("th",{class:"px-4 py-2"},"Class"),e("th",{class:"px-4 py-2"},"Year"),e("th",{class:"px-4 py-2"},"Actions")])],-1)),e("tbody",null,[(u(!0),c(A,null,F(E.value,a=>(u(),c("tr",{key:a.id,class:"text-center border-t border-gray-200"},[e("td",Se,m(a.subject_name),1),e("td",_e,m(a.course)+" "+m(a.year)+"-"+m(a.section),1),e("td",Ie,m(a.year),1),e("td",je,[e("button",{onClick:Z=>J(a.id),class:"text-red-500 hover:text-red-700 text-md transition",title:"Delete assignment"}," Delete ",8,Be)])]))),128)),E.value.length===0?(u(),c("tr",Me,o[5]||(o[5]=[e("td",{colspan:"4",class:"py-4 text-gray-500 text-center"},"No assignments yet.",-1)]))):q("",!0)])]))],2),$.value?(u(),c("form",{key:0,onSubmit:re(O,["prevent"]),class:"space-y-4 mb-4"},[e("div",Te,[o[7]||(o[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1 select-none"},"Subject",-1)),k(e("input",{"onUpdate:modelValue":o[0]||(o[0]=a=>M.value=a),onInput:l,placeholder:"Type to search subject...",class:"w-full rounded-md border border-gray-300 bg-white text-gray-800 px-3 py-2 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-mccblue focus:border-mccblue transition",required:""},null,544),[[L,M.value]]),T.value.length?(u(),c("div",Le,[(u(!0),c(A,null,F(T.value,a=>(u(),c("div",{key:a.id,onClick:Z=>t(a),class:"px-3 py-2 hover:bg-gray-200 text-gray-800 cursor-pointer"},m(a.title),9,Ae))),128))])):q("",!0)]),e("div",Fe,[e("div",null,[o[9]||(o[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1 select-none"},"Course",-1)),k(e("select",{"onUpdate:modelValue":o[1]||(o[1]=a=>i.value.course=a),class:"w-full rounded-md border border-gray-300 bg-white text-gray-800 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-mccblue focus:border-mccblue transition",required:""},[o[8]||(o[8]=e("option",{value:"",disabled:""},"Select course",-1)),(u(),c(A,null,F(U,a=>e("option",{key:a},m(a),1)),64))],512),[[W,i.value.course]])]),e("div",null,[o[11]||(o[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1 select-none"},"Year",-1)),k(e("select",{"onUpdate:modelValue":o[2]||(o[2]=a=>i.value.year=a),class:"w-full rounded-md border border-gray-300 bg-white text-gray-800 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-mccblue focus:border-mccblue transition",required:""},[o[10]||(o[10]=e("option",{value:"",disabled:""},"Select year",-1)),(u(),c(A,null,F([1,2,3,4],a=>e("option",{key:a},m(a),1)),64))],512),[[W,i.value.year]])]),e("div",null,[o[13]||(o[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1 select-none"},"Section",-1)),k(e("select",{"onUpdate:modelValue":o[3]||(o[3]=a=>i.value.section=a),class:"w-full rounded-md border border-gray-300 bg-white text-gray-800 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-mccblue focus:border-mccblue transition",required:""},[o[12]||(o[12]=e("option",{value:"",disabled:""},"Select section",-1)),(u(),c(A,null,F(S,a=>e("option",{key:a},m(a),1)),64))],512),[[W,i.value.section]])])]),o[14]||(o[14]=e("div",{class:"flex justify-end pt-2"},[e("button",{type:"submit",class:"bg-mccblue hover:bg-mccdarkblue text-white px-4 py-2 rounded-md transition"}," Save Assignment ")],-1))],32)):q("",!0),e("button",{onClick:X,class:"absolute top-4 right-4 text-gray-500 text-2xl hover:text-red-500 transition"}," × ")])])):q("",!0)]),_:1})]))}},Ve=de(Ne,[["__scopeId","data-v-0e2b7f42"]]),Ue={class:"flex flex-col md:flex-row justify-between items-center p-5"},De={class:"mb-2 md:mb-0"},Pe=["value"],ze={class:"flex"},qe={class:"p-4 space-y-6 animate-slide-in-top"},Oe={class:"overflow-x-auto rounded-lg border shadow"},Ye={class:"min-w-full bg-white"},Ge={class:"bg-mcclightblue text-white"},We=["onClick"],He={key:0},Je={class:"px-4 py-2 text-center"},Ke={class:"px-4 py-2 text-center"},Re={class:"px-4 py-2 text-center"},Qe={class:"px-4 py-2 text-center"},Xe={class:"px-4 py-2 text-center space-x-2"},Ze=["onClick"],et=["onClick"],tt=["onClick"],st={key:0},ot={class:"flex justify-between bg-mcclightblue items-center px-2 text-sm text-white select-none"},nt={class:"font-semibold"},lt={class:"font-semibold"},rt={class:"font-semibold"},at={class:"flex gap-1"},it=["disabled"],dt=["onClick"],ut=["disabled"],bt={__name:"CourseInstructors",setup(V){const y=me().props.department,x=v(""),C=v(""),$=v([]),r=v(""),E=v(null),U=v(""),S=v([{key:"lname",direction:"asc"}]),i=v(10),h=v(1),M=[{key:"id",label:"ID"},{key:"fname",label:"First Name"},{key:"lname",label:"Last Name"},{key:"sex",label:"Gender"}],T=p=>{l.value=!0,t.value={...p}},l=v(!1),t=v(null),b=()=>{l.value=!1,t.value=null},J=v(null),K=p=>{J.value=p,E.value.openModal()},X=async()=>{try{const p=await j.get("/session");x.value=p.data.fullname,C.value=p.data.level,r.value=p.data.username,(!x.value||!C.value)&&(window.location.href="/")}catch{window.location.href="/"}},N=async()=>{try{const p=await j.get(`/api/instructors/${y}`);$.value=p.data,h.value=1}catch(p){console.error("Error fetching instructors:",p)}},D=ee(()=>[...$.value].sort((n,s)=>{for(const g of S.value){const I=g.key,B=g.direction;if(n[I]<s[I])return B==="asc"?-1:1;if(n[I]>s[I])return B==="asc"?1:-1}return 0}).filter(n=>Object.values(n).join(" ").toLowerCase().includes(U.value.toLowerCase()))),O=ee(()=>{const p=(h.value-1)*i.value;return D.value.slice(p,p+i.value)}),Y=ee(()=>Math.ceil(D.value.length/i.value)),d=()=>{h.value=1},o=p=>{const n=S.value.findIndex(s=>s.key===p);n!==-1?S.value[n].direction=S.value[n].direction==="asc"?"desc":"asc":S.value.push({key:p,direction:"asc"})},a=async p=>{if((await f.fire({title:"Move to Trash?",text:"Move instructor record to trash?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#e3342f",cancelButtonColor:"#6c757d",confirmButtonText:"Yes"})).isConfirmed)try{await j.delete(`/instructors/${p}`),await N(),f.fire({icon:"success",title:"Moved to Trash",toast:!0,position:"top-end",timer:2e3,showConfirmButton:!1})}catch{f.fire("Error","Failed to delete instructor","error")}},Z=()=>{const p="/imports/instructor-loads";let n=null;f.fire({title:"Import Instructor Loads",html:`
      <div id="dz"
           class="mt-2 border-2 border-dashed rounded-lg p-6 text-sm
                  bg-white hover:bg-gray-50 transition-colors
                  border-gray-300 text-gray-600">
        <div class="pointer-events-none select-none">
          <div class="font-semibold text-gray-800 mb-1 text-lg">Drag & drop file here</div>
          <div class="text-md opacity-80 mb-3">Accepted: .xlsx, .xls, .csv</div>
        </div>
        <div class="items-center gap-2">
          <button id="browseBtn"
                  class="px-4 py-2 rounded bg-mccblue text-white text-md hover:opacity-90">
            Browse
          </button>
          <span id="fileName" class="text-xs"></span>
        </div>
        <input id="fileInput" type="file" accept=".xlsx,.xls,.csv" class="hidden" />

        <div id="progressWrap" class="mt-4 hidden">
          <div class="h-2 w-full bg-gray-200 rounded">
            <div id="bar" class="h-2 bg-mccblue rounded" style="width:0%"></div>
          </div>
          <div id="pct" class="text-xs mt-1 text-gray-600">0%</div>
        </div>
      </div>
    `,showCancelButton:!0,confirmButtonText:"Upload",confirmButtonColor:"#16a34a",width:600,focusConfirm:!1,allowOutsideClick:()=>!f.isLoading(),didOpen:()=>{const s=document.getElementById("dz"),g=document.getElementById("fileInput"),I=document.getElementById("browseBtn"),B=document.getElementById("fileName"),P=["xlsx","xls","csv"],_=w=>{if(!w)return;const z=(w.name.split(".").pop()||"").toLowerCase();if(!P.includes(z)){n=null,B.textContent="",f.showValidationMessage("Invalid file type. Please upload a .xlsx or .csv file.");return}n=w,B.textContent=`${w.name} (${Math.round(w.size/1024)} KB)`,f.resetValidationMessage()};I.addEventListener("click",()=>g.click()),g.addEventListener("change",w=>{var z;return _((z=w.target.files)==null?void 0:z[0])});const R=w=>{w.preventDefault(),w.stopPropagation()};["dragenter","dragover","dragleave","drop"].forEach(w=>s.addEventListener(w,R)),s.addEventListener("dragenter",()=>s.classList.add("bg-gray-50")),s.addEventListener("dragleave",()=>s.classList.remove("bg-gray-50")),s.addEventListener("drop",w=>{var z,oe;s.classList.remove("bg-gray-50"),_((oe=(z=w.dataTransfer)==null?void 0:z.files)==null?void 0:oe[0])})},preConfirm:async()=>{var g,I,B,P;if(!n)return f.showValidationMessage("Please select a file first."),!1;const s=new FormData;s.append("file",n);try{return(await j.post(p,s,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:R=>{}})).data}catch(_){const R=((I=(g=_==null?void 0:_.response)==null?void 0:g.data)==null?void 0:I.error)||((P=(B=_==null?void 0:_.response)==null?void 0:B.data)==null?void 0:P.message)||_.message;return f.showValidationMessage(R),!1}}}).then(async s=>{if(s.isConfirmed&&s.value){const{inserted:g=0,updated:I=0,skipped:B=0,errors:P=[]}=s.value;await f.fire({icon:"success",title:"Import completed",html:`<div class="text-left">
                 <div><b>Inserted:</b> ${g}</div>
                 <div><b>Updated:</b> ${I}</div>
                 <div><b>Skipped:</b> ${B}</div>
                 ${P.length?`<hr class="my-2"/><div class="text-sm max-h-40 overflow-auto">${P.map(_=>`<div>• ${_}</div>`).join("")}</div>`:""}
               </div>`}),await(N==null?void 0:N())||await(fetchAssignments==null?void 0:fetchAssignments())||await(fetchData==null?void 0:fetchData())}})};return pe(()=>{X(),N()}),(p,n)=>(u(),le(ve,{fullname:x.value,userLevel:C.value,title:`Instructors – ${te(y)}`},{default:se(()=>[e("div",Ue,[e("div",De,[n[5]||(n[5]=e("label",{class:"mr-2"},"Show",-1)),k(e("select",{"onUpdate:modelValue":n[0]||(n[0]=s=>i.value=s),onChange:d,class:"border py-1 rounded"},[(u(),c(A,null,F([10,25,50,100],s=>e("option",{key:s,value:s},m(s),9,Pe)),64))],544),[[W,i.value]]),n[6]||(n[6]=e("span",{class:"ml-2"},"entries",-1))]),k(e("input",{"onUpdate:modelValue":n[1]||(n[1]=s=>U.value=s),onInput:d,type:"text",placeholder:"Search instructors...",class:"border px-3 py-1 rounded w-full md:w-64 ml-[62px]"},null,544),[[L,U.value]]),e("div",ze,[e("button",{onClick:Z,class:"bg-mccblue text-white px-4 py-2 rounded-lg hover:bg-mccdarkblue transition"}," Import "),Q(ye,{course:te(y),class:"ml-4",editMode:l.value,instructorToEdit:t.value,onSubmitted:N,onCancelEdit:b},null,8,["course","editMode","instructorToEdit"])])]),Q(Ve,{course:te(y),ref_key:"assignmentForm",ref:E,instructor:J.value},null,8,["course","instructor"]),e("div",qe,[e("div",Oe,[e("table",Ye,[e("thead",Ge,[e("tr",null,[(u(),c(A,null,F(M,s=>e("th",{key:s.key,class:"px-4 py-2 text-center cursor-pointer select-none",onClick:g=>o(s.key)},[G(m(s.label)+" ",1),S.value.find(g=>g.key===s.key)?(u(),c("span",He,m(S.value.find(g=>g.key===s.key).direction==="asc"?"▲":"▼"),1)):q("",!0)],8,We)),64)),n[7]||(n[7]=e("th",{class:"px-4 py-2 text-center"},"Actions",-1))])]),e("tbody",null,[(u(!0),c(A,null,F(O.value,s=>(u(),c("tr",{key:s.id,class:"hover:bg-gray-100"},[e("td",Je,m(s.teachid),1),e("td",Ke,m(s.fname),1),e("td",Re,m(s.lname),1),e("td",Qe,m(s.sex),1),e("td",Xe,[e("button",{onClick:g=>K(s),class:"text-green-600 hover:underline select-none"},"View Subjects",8,Ze),e("button",{onClick:g=>T(s),class:"text-blue-600 hover:underline select-none"},"Edit",8,et),e("button",{onClick:g=>a(s.id),class:"text-red-600 hover:underline select-none"},"Delete",8,tt)])]))),128)),O.value.length===0?(u(),c("tr",st,n[8]||(n[8]=[e("td",{colspan:"5",class:"text-center py-4"},"No instructors found.",-1)]))):q("",!0)])]),e("div",ot,[e("div",null,[n[9]||(n[9]=G(" Showing ")),e("span",nt,m(O.value.length?(h.value-1)*i.value+1:0),1),n[10]||(n[10]=G(" to ")),e("span",lt,m((h.value-1)*i.value+O.value.length),1),n[11]||(n[11]=G(" of ")),e("span",rt,m(D.value.length),1),n[12]||(n[12]=G(" entries "))]),e("div",at,[e("button",{onClick:n[2]||(n[2]=s=>S.value=[]),class:"text-sm hover:bg-mccblue px-2 py-1 rounded transition"}," Clear Sorting "),e("button",{onClick:n[3]||(n[3]=s=>h.value--),disabled:h.value===1,class:"px-3 py-1 rounded disabled:opacity-50 disabled:hover:bg-mcclightblue hover:bg-mccblue"}," Prev ",8,it),(u(!0),c(A,null,F(Y.value,s=>(u(),c("button",{key:s,onClick:g=>h.value=s,class:ie(["px-3 py-1 rounded",h.value===s?"bg-white text-mccblue font-bold":"hover:bg-mccblue transition"])},m(s),11,dt))),128)),e("button",{onClick:n[4]||(n[4]=s=>h.value++),disabled:h.value===Y.value,class:"px-3 py-1 rounded disabled:opacity-50 disabled:hover:bg-mcclightblue hover:bg-mccblue transition"}," Next ",8,ut)])])])])]),_:1},8,["fullname","userLevel","title"]))}};export{bt as default};
