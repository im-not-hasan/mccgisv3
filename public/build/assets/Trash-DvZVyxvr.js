import{r as l,o as Y,b as E,d as n,w as F,e as t,g as a,i as C,F as _,h as B,t as c,a as i}from"./app-BzR5gmBy.js";import{S as o}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{_ as L}from"./DashboardLayout-XlP5Gg7c.js";const j={class:"max-w-5xl mx-auto space-y-6"},N={class:"p-6 rounded-xl shadow-xl bg-white text-gray-800"},q={class:"w-full border-separate border-spacing-y-2 table-fixed"},I={key:0},V={class:"px-4 py-2"},M={class:"px-4 py-2"},z={class:"px-4 py-2 text-right"},G={class:"flex justify-end items-center gap-4"},H=["onClick"],J=["onClick"],K={key:2},O={class:"p-6 rounded-xl shadow-xl bg-white text-gray-800"},Q={class:"w-full border-separate border-spacing-y-2 table-fixed"},U={key:0},W={class:"px-4 py-2"},X={class:"px-4 py-2 text-center"},Z={class:"px-4 py-2 text-right"},tt={class:"flex justify-end items-center gap-4"},et=["onClick"],rt=["onClick"],st={key:2},ot={class:"p-6 rounded-xl shadow-xl bg-white text-gray-800"},nt={class:"w-full border-separate border-spacing-y-2 table-fixed"},at={key:0},it={class:"px-4 py-2"},lt={class:"px-4 py-2 text-right"},ct={class:"flex justify-end items-center gap-4"},ut=["onClick"],dt=["onClick"],mt={key:2},pt={__name:"Trash",setup(ft){const h=l(""),d=l(""),k=l(""),x=l([]),p=l([]),b=l([]),m=l(!1),f=l(!1),y=l(!1),T=async()=>{try{const e=await i.get("/session");h.value=e.data.fullname,d.value=e.data.level,k.value=e.data.username,(!h.value||!d.value)&&(window.location.href="/")}catch{window.location.href="/"}},w=async()=>{try{m.value=!0;const{data:e}=await i.get("/students/settings/archived");b.value=Array.isArray(e)?e:[]}catch(e){console.error("Failed to fetch student trash:",e)}finally{m.value=!1}},g=async()=>{try{f.value=!0;const{data:e}=await i.get("/ay/archived");x.value=Array.isArray(e)?e:[]}catch(e){console.error("Failed to fetch AY trash:",e)}finally{f.value=!1}},v=async()=>{try{y.value=!0;const{data:e}=await i.get("/curriculums/archived");p.value=Array.isArray(e)?e:[]}catch(e){console.error("Failed to fetch curriculum trash:",e)}finally{y.value=!1}},$=async e=>{if((await o.fire({title:"Restore from Trash?",text:`Restore student ${e.fname} ${e.lname} (ID: ${e.studid})?`,icon:"question",showCancelButton:!0,confirmButtonColor:"#16a34a",cancelButtonColor:"#6b7280",confirmButtonText:"Restore"})).isConfirmed)try{await i.post(`/students/settings/${e.id}/restore`),await w(),o.fire({icon:"success",title:"Restored from Trash",toast:!0,position:"top-end",timer:2e3,showConfirmButton:!1})}catch{o.fire("Error","Could not restore student","error")}},D=async e=>{if((await o.fire({title:"Delete Permanently?",html:`
      <p class="text-sm text-gray-700">
        This will <b>permanently delete</b> student ${e.fname} ${e.lname}
        (ID: ${e.studid}).<br>
        This action cannot be undone.
      </p>
    `,icon:"error",showCancelButton:!0,confirmButtonColor:"#b91c1c",cancelButtonColor:"#6b7280",confirmButtonText:"Delete Permanently"})).isConfirmed)try{await i.delete(`/students/settings/${e.id}/force-delete`),await w(),o.fire({icon:"success",title:"Permanently Deleted",toast:!0,position:"top-end",timer:2e3,showConfirmButton:!1})}catch{o.fire("Error","Could not permanently delete student","error")}},S=async e=>{if((await o.fire({title:"Restore from Trash?",text:`Restore Academic Year ${e.academicyear} (${e.semester==="1"?"First Semester":e.semester==="2"?"Second Semester":"Summer"}) back to the active list?`,icon:"question",showCancelButton:!0,confirmButtonColor:"#16a34a",cancelButtonColor:"#6b7280",confirmButtonText:"Restore"})).isConfirmed)try{await i.post(`/ay/${e.id}/restore`),await g(),o.fire({icon:"success",title:"Restored from Trash",toast:!0,position:"top-end",timer:2e3,showConfirmButton:!1})}catch{o.fire("Error","Could not restore academic year","error")}},A=async e=>{if((await o.fire({title:"Delete Permanently?",html:`
      <p class="text-sm text-gray-700">
        This will <b>permanently delete</b> Academic Year ${e.academicyear}.<br>
        This action cannot be undone.
      </p>
    `,icon:"error",showCancelButton:!0,confirmButtonColor:"#b91c1c",cancelButtonColor:"#6b7280",confirmButtonText:"Delete Permanently"})).isConfirmed)try{await i.delete(`/ay/${e.id}/force-delete`),await g(),o.fire({icon:"success",title:"Permanently Deleted",toast:!0,position:"top-end",timer:2e3,showConfirmButton:!1})}catch{o.fire("Error","Could not permanently delete academic year","error")}},R=async e=>{if((await o.fire({title:"Restore from Trash?",text:`Restore Curriculum ${e.curriculum} back to the active list?`,icon:"question",showCancelButton:!0,confirmButtonColor:"#16a34a",cancelButtonColor:"#6b7280",confirmButtonText:"Restore"})).isConfirmed)try{await i.post(`/curriculums/${e.id}/restore`),await v(),o.fire({icon:"success",title:"Restored from Trash",toast:!0,position:"top-end",timer:2e3,showConfirmButton:!1})}catch{o.fire("Error","Could not restore curriculum","error")}},P=async e=>{if((await o.fire({title:"Delete Permanently?",html:`
      <p class="text-sm text-gray-700">
        This will <b>permanently delete</b> Curriculum ${e.curriculum}.<br>
        This action cannot be undone.
      </p>
    `,icon:"error",showCancelButton:!0,confirmButtonColor:"#b91c1c",cancelButtonColor:"#6b7280",confirmButtonText:"Delete Permanently"})).isConfirmed)try{await i.delete(`/curriculums/${e.id}/force-delete`),await v(),o.fire({icon:"success",title:"Permanently Deleted",toast:!0,position:"top-end",timer:2e3,showConfirmButton:!1})}catch{o.fire("Error","Could not permanently delete curriculum","error")}};return Y(async()=>{if(await T(),d.value!=="admin"){window.location.href="/";return}g(),v(),w()}),(e,r)=>(n(),E(L,{fullname:h.value,userLevel:d.value,title:"Trash",class:"animate-slide-in-top"},{default:F(()=>[t("div",j,[t("div",N,[r[3]||(r[3]=t("div",{class:"md:flex md:justify-between items-center"},[t("h2",{class:"text-2xl font-semibold mb-2 md:mb-4 ml-2 text-mccblue"}," Students ")],-1)),r[4]||(r[4]=t("hr",{class:"border-t border-gray-300 mb-4"},null,-1)),t("table",q,[r[2]||(r[2]=t("thead",{class:"bg-mccblue text-white"},[t("tr",null,[t("th",{class:"px-4 py-2 w-1/3 text-left"},"Student ID"),t("th",{class:"px-4 py-2 w-1/3 text-left"},"Name"),t("th",{class:"px-4 py-2 w-1/3 text-right"},"Actions")])],-1)),t("tbody",null,[m.value?(n(),a("tr",I,r[0]||(r[0]=[t("td",{colspan:"3",class:"text-center py-4 text-gray-500"}," Loading students... ",-1)]))):(n(!0),a(_,{key:1},B(b.value,s=>(n(),a("tr",{key:s.id,class:"bg-white text-gray-800 border hover:bg-gray-100 transition"},[t("td",V,c(s.studid),1),t("td",M,c(s.fname)+" "+c(s.lname),1),t("td",z,[t("div",G,[t("button",{onClick:u=>$(s),class:"text-green-600 hover:text-green-800 text-sm font-medium"}," Restore ",8,H),t("button",{onClick:u=>D(s),class:"text-red-600 hover:text-red-800 text-sm font-medium"}," Delete Permanently ",8,J)])])]))),128)),!m.value&&b.value.length===0?(n(),a("tr",K,r[1]||(r[1]=[t("td",{colspan:"3",class:"text-center py-4 text-gray-500"}," No student records in trash. ",-1)]))):C("",!0)])])]),t("div",O,[r[8]||(r[8]=t("div",{class:"md:flex md:justify-between items-center"},[t("h2",{class:"text-2xl font-semibold mb-2 md:mb-4 ml-2 text-mccblue"}," Academic Years ")],-1)),r[9]||(r[9]=t("hr",{class:"border-t border-gray-300 mb-4"},null,-1)),t("table",Q,[r[7]||(r[7]=t("thead",{class:"bg-mccblue text-white"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left w-1/3"},"Academic Year"),t("th",{class:"px-4 py-2 text-center w-1/3"},"Semester"),t("th",{class:"px-4 py-2 text-right w-1/3"},"Actions")])],-1)),t("tbody",null,[f.value?(n(),a("tr",U,r[5]||(r[5]=[t("td",{colspan:"3",class:"text-center py-4 text-gray-500"}," Loading academic years... ",-1)]))):(n(!0),a(_,{key:1},B(x.value,s=>(n(),a("tr",{key:s.id,class:"bg-white text-gray-800 border hover:bg-gray-100 transition"},[t("td",W,c(s.academicyear),1),t("td",X,c(s.semester==="1"?"First Semester":s.semester==="2"?"Second Semester":"Summer"),1),t("td",Z,[t("div",tt,[t("button",{onClick:u=>S(s),class:"text-green-600 hover:text-green-800 text-sm font-medium",title:"Restore from Trash"}," Restore ",8,et),t("button",{onClick:u=>A(s),class:"text-red-600 hover:text-red-800 text-sm font-medium",title:"Delete Permanently"}," Delete Permanently ",8,rt)])])]))),128)),!f.value&&x.value.length===0?(n(),a("tr",st,r[6]||(r[6]=[t("td",{colspan:"3",class:"text-center py-4 text-gray-500"}," No academic years in trash. ",-1)]))):C("",!0)])])]),t("div",ot,[r[13]||(r[13]=t("div",{class:"md:flex md:justify-between items-center"},[t("h2",{class:"text-2xl font-semibold mb-2 md:mb-4 ml-2 text-mccblue"}," Curriculums ")],-1)),r[14]||(r[14]=t("hr",{class:"border-t border-gray-300 mb-4"},null,-1)),t("table",nt,[r[12]||(r[12]=t("thead",{class:"bg-mccblue text-white"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left w-2/3"},"Curriculum"),t("th",{class:"px-4 py-2 text-right w-1/3"},"Actions")])],-1)),t("tbody",null,[y.value?(n(),a("tr",at,r[10]||(r[10]=[t("td",{colspan:"2",class:"text-center py-4 text-gray-500"}," Loading curriculums... ",-1)]))):(n(!0),a(_,{key:1},B(p.value,s=>(n(),a("tr",{key:s.id,class:"bg-white text-gray-800 border hover:bg-gray-100 transition"},[t("td",it," Curriculum "+c(s.curriculum),1),t("td",lt,[t("div",ct,[t("button",{onClick:u=>R(s),class:"text-green-600 hover:text-green-800 text-sm font-medium",title:"Restore from Trash"}," Restore ",8,ut),t("button",{onClick:u=>P(s),class:"text-red-600 hover:text-red-800 text-sm font-medium",title:"Delete Permanently"}," Delete Permanently ",8,dt)])])]))),128)),!y.value&&p.value.length===0?(n(),a("tr",mt,r[11]||(r[11]=[t("td",{colspan:"2",class:"text-center py-4 text-gray-500"}," No curriculums in trash. ",-1)]))):C("",!0)])])])])]),_:1},8,["fullname","userLevel"]))}};export{pt as default};
