import{r as o,c as x,o as z,K as F,b as h,d as p,w as $,e as a,l as b,g as A,F as M,h as N,u as O,W as y,t as i,a as _}from"./app-CGObjEgI.js";import{_ as T}from"./DashboardLayout-DpZzYcFP.js";import{_ as S}from"./CardSpotlight.vue_vue_type_script_setup_true_lang-WubcN7tc.js";import"./index-CsRA-HnP.js";import"./sweetalert2.esm.all-BQIkj5Wb.js";const V={class:"flex flex-col md:flex-row gap-6 p-1"},E={class:"flex-1 bg-white rounded-lg shadow p-4"},j={class:"grid grid-cols-1 md:grid-cols-2"},G={class:"flex flex-col justify-between space-y-2"},H={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-6 px-4"},K={class:"bg-white shadow p-4 rounded-lg text-center"},P={class:"text-3xl font-bold text-mcclightblue"},U={class:"bg-white shadow p-4 rounded-lg text-center"},q={class:"text-2xl font-bold text-gray-700"},J={class:"bg-white shadow p-4 rounded-lg text-center"},Q={class:"text-2xl font-bold text-mcclightblue"},le={__name:"Students",setup(X){const w=e=>{y.visit(`/students/${e}`)},u=o(""),c=o(""),C=o(""),d=o({}),g=o({}),r=o({total:0,male:0,female:0,regular:0,irregular:0}),v=o({}),k=o({}),n=o([{label:"BSIT",count:0,color:"#dc2626"},{label:"BSBA",count:0,color:"#16a34a"},{label:"BSHM",count:0,color:"#ea580c"},{label:"EDUC",count:0,color:"#1e3a8a"}]),B=async()=>{try{const e=await _.get("/session");u.value=e.data.fullname,c.value=e.data.level,C.value=e.data.username,(!u.value||!c.value)&&(window.location.href="/")}catch{window.location.href="/"}},L=async()=>{try{const e=await _.get("/student-stats");d.value=e.data.byCourse,v.value=e.data.byCourseRegular||{},k.value=e.data.byCourseIrregular||{},g.value=e.data.byGender,r.value=e.data.totals,n.value=n.value.map(t=>({...t,count:d.value[t.label]||0}))}catch(e){console.error("Failed to fetch student stats:",e)}},I=x(()=>{const e=n.value.map(l=>l.label),t=e.map(l=>v.value[l]||0),s=e.map(l=>d.value[l]||0).map((l,D)=>{const W=t[D],f=l-W;return f<0?0:f});return{tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["Regular","Irregular"]},xAxis:{type:"category",data:e,axisLabel:{fontWeight:"bold",color:"#374151"}},yAxis:{type:"value",axisLabel:{color:"#6B7280"}},series:[{name:"Regular",type:"bar",stack:"total",barWidth:"50%",data:t,itemStyle:{borderRadius:[6,6,0,0],color:l=>n.value[l.dataIndex].color}},{name:"Irregular",type:"bar",stack:"total",barWidth:"50%",data:s,itemStyle:{borderRadius:[6,6,0,0],color:"#22c55e"}}],grid:{left:"5%",right:"5%",bottom:"10%",top:"10%",containLabel:!0}}}),R=x(()=>({tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},series:[{type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,label:{show:!1},emphasis:{label:{show:!0,fontSize:16,fontWeight:"bold"}},labelLine:{show:!1},data:[{value:g.value.male||0,name:"Male",itemStyle:{color:"#3b82f6"}},{value:g.value.female||0,name:"Female",itemStyle:{color:"#f472b6"}}]}]}));return z(()=>{B(),L()}),(e,t)=>{const m=F("v-chart");return p(),h(T,{fullname:u.value,userLevel:c.value,title:"Students",class:"animate-slide-in-top"},{default:$(()=>[a("div",V,[a("div",E,[t[1]||(t[1]=a("h2",{class:"text-sm md:text-lg font-semibold text-gray-700 mb-2"},"Student Statistics",-1)),a("div",j,[b(m,{option:I.value,autoresize:"",class:"h-[300px]"},null,8,["option"]),b(m,{option:R.value,autoresize:"",class:"h-[300px]"},null,8,["option"])])]),a("div",G,[(p(!0),A(M,null,N(n.value,s=>(p(),h(S,{key:s.label,label:s.label,count:s.count,iconName:"students",useSvg:!0,bgColor:s.color,gradientSize:0,class:"cursor-pointer md:w-[300px] h-[90px]",onClick:l=>w(s.label)},null,8,["label","count","bgColor","onClick"]))),128)),b(S,{label:"View All Students",count:e.totalClasses,iconName:"students",useSvg:!0,bgColor:"#3b82f6",gradientSize:0,class:"cursor-pointer h-[90px]",onClick:t[0]||(t[0]=s=>O(y).visit("/students/all"))},null,8,["count"])])]),a("div",H,[a("div",K,[t[2]||(t[2]=a("h3",{class:"text-gray-700 font-semibold text-lg"},"Total Students",-1)),a("p",P,i(r.value.total),1)]),a("div",U,[t[3]||(t[3]=a("h3",{class:"text-gray-700 font-semibold text-lg"},"Male / Female",-1)),a("p",q," ðŸ‘¨ "+i(r.value.male)+" Â Â  ðŸ‘© "+i(r.value.female),1)]),a("div",J,[t[4]||(t[4]=a("h3",{class:"text-gray-700 font-semibold text-lg"},"Regular / Irregular",-1)),a("p",Q,i(r.value.regular||0)+" / "+i(r.value.irregular||0),1)])])]),_:1},8,["fullname","userLevel"])}}};export{le as default};
