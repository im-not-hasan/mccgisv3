import{r as c,c as x,o as G,b as L,d as a,w as V,g as o,e as t,k as m,t as l,F as p,h as b,i as D,a as g}from"./app-snvesE-I.js";import{_ as E}from"./DashboardLayout-CjeStfyO.js";import"./sweetalert2.esm.all-BQIkj5Wb.js";const F={key:0,class:"flex justify-center py-10"},N={key:1},S={class:"bg-white rounded shadow p-4 mb-4 flex flex-wrap gap-4 justify-between items-center"},T={class:"text-sm text-gray-700"},U={class:"font-semibold"},O={class:"text-xs text-gray-500 mt-1"},R={class:"font-semibold"},M={class:"font-semibold"},P={class:"text-center md:text-xl text-lg font-semibold text-mccblue mb-2"},W={class:"text-center md:text-lg text-md font-semibold text-mccblue py-2"},z={class:"min-w-full bg-white rounded-b-lg overflow-hidden"},A={class:"py-2 px-4 text-center font-medium md:text-base text-xs"},H={class:"py-2 px-4 text-center md:text-base text-xs"},$={class:"py-2 px-4 text-center md:text-base text-xs"},q={class:"py-2 px-4 text-center md:text-base text-xs"},I={key:0},J={key:1,class:"text-gray-400"},K={key:0},tt={__name:"ViewGrades",setup(Q){const _=c(""),w=c(""),h=c(!0),d=c(null),u=c({}),k=async()=>{const s=await g.get("/student/viewgrades/data");d.value=s.data.curriculum,u.value=s.data.grouped},f=x(()=>{const s=[];return Object.values(u.value).forEach(e=>{Object.values(e).forEach(n=>{n.forEach(i=>s.push(i))})}),s}),j=x(()=>f.value.length),C=x(()=>f.value.filter(s=>s.grade!==null&&s.grade!==void 0&&s.grade!=="").length),B=async()=>{try{const s=await g.get("/viewgrades/download",{responseType:"blob"}),e=new Blob([s.data],{type:"application/pdf"}),n=document.createElement("a");n.href=window.URL.createObjectURL(e),n.download="gradeslip.pdf",n.click(),window.URL.revokeObjectURL(n.href)}catch(s){console.error("Failed to download PDF:",s)}};return G(async()=>{try{await k()}finally{h.value=!1}}),(s,e)=>(a(),L(E,{fullname:_.value,userLevel:w.value,title:"View Grades",class:"animate-slide-in-top"},{default:V(()=>[h.value?(a(),o("div",F,e[0]||(e[0]=[t("svg",{class:"animate-spin h-8 w-8 text-mccblue",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})],-1)]))):(a(),o("div",N,[t("div",S,[t("div",null,[t("p",T,[e[1]||(e[1]=m(" Curriculum: ")),t("span",U,l(d.value!==null&&d.value!==void 0?d.value:"Active"),1)]),t("p",O,[e[2]||(e[2]=m(" Total Subjects: ")),t("span",R,l(j.value),1),e[3]||(e[3]=m(" • With Grades: ")),t("span",M,l(C.value),1)])]),t("div",null,[t("button",{onClick:B,class:"bg-mccblue hover:bg-mccdarkblue text-white px-4 py-2 rounded-md text-sm font-medium transition"}," Download a Copy ")])]),(a(!0),o(p,null,b(u.value,(n,i)=>(a(),o("div",{key:i,class:"mb-6"},[t("h2",P,l(i),1),(a(!0),o(p,null,b(n,(y,v)=>(a(),o("div",{key:v,class:"bg-white rounded shadow mb-4"},[t("h3",W,l(v),1),t("table",z,[e[5]||(e[5]=t("thead",{class:"bg-mcclightblue text-white"},[t("tr",null,[t("th",{class:"py-2 px-4 text-center md:text-base text-xs"},"Subject Code"),t("th",{class:"py-2 px-4 text-center md:text-base text-xs"},"Descriptive Title"),t("th",{class:"py-2 px-4 text-center md:text-base text-xs"},"Total Units"),t("th",{class:"py-2 px-4 text-center md:text-base text-xs"},"Grade")])],-1)),t("tbody",null,[(a(!0),o(p,null,b(y,r=>(a(),o("tr",{key:r.code,class:"hover:bg-gray-100 transition"},[t("td",A,l(r.code),1),t("td",H,l(r.title),1),t("td",$,l(r.total_units),1),t("td",q,[r.grade?(a(),o("span",I,l(Number(r.grade).toFixed(1)),1)):(a(),o("span",J,"–"))])]))),128)),y.length?D("",!0):(a(),o("tr",K,e[4]||(e[4]=[t("td",{colspan:"4",class:"text-center py-3 text-gray-500"}," No subjects found for this semester. ",-1)])))])])]))),128))]))),128))]))]),_:1},8,["fullname","userLevel"]))}};export{tt as default};
