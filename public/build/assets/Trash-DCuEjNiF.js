import{r as l,o as L,b as N,d as n,w as q,e as t,g as a,i as x,F as p,h as b,t as c,a as i}from"./app-8qenG6k4.js";import{S as o}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{_ as V}from"./DashboardLayout-yVP8rKql.js";const M={class:"max-w-5xl mx-auto space-y-6"},z={class:"p-6 rounded-xl shadow-xl bg-white text-gray-800"},G={class:"w-full border-separate border-spacing-y-2 table-fixed"},H={key:0},J={class:"px-4 py-2"},K={class:"px-4 py-2"},O={class:"px-4 py-2 text-right"},Q={class:"flex justify-end items-center gap-4"},U=["onClick"],W=["onClick"],X={key:2},Z={class:"p-6 rounded-xl shadow-xl bg-white text-gray-800"},tt={class:"w-full border-separate border-spacing-y-2 table-fixed"},et={key:0},rt={class:"px-4 py-2"},st={class:"px-4 py-2"},ot={class:"px-4 py-2 text-right"},nt={class:"flex justify-end items-center gap-4"},at=["onClick"],it=["onClick"],lt={key:2},ct={class:"p-6 rounded-xl shadow-xl bg-white text-gray-800"},ut={class:"w-full border-separate border-spacing-y-2 table-fixed"},dt={key:0},mt={class:"px-4 py-2"},ft={class:"px-4 py-2 text-center"},ht={class:"px-4 py-2 text-right"},yt={class:"flex justify-end items-center gap-4"},xt=["onClick"],pt=["onClick"],bt={key:2},gt={class:"p-6 rounded-xl shadow-xl bg-white text-gray-800"},wt={class:"w-full border-separate border-spacing-y-2 table-fixed"},vt={key:0},Ct={class:"px-4 py-2"},_t={class:"px-4 py-2 text-right"},Bt={class:"flex justify-end items-center gap-4"},Tt=["onClick"],kt=["onClick"],$t={key:2},Pt={__name:"Trash",setup(Dt){const g=l(""),d=l(""),D=l(""),w=l([]),v=l([]),C=l([]),_=l([]),m=l(!1),f=l(!1),h=l(!1),y=l(!1),R=async()=>{try{const e=await i.get("/session");g.value=e.data.fullname,d.value=e.data.level,D.value=e.data.username,(!g.value||!d.value)&&(window.location.href="/")}catch{window.location.href="/"}},B=async()=>{try{m.value=!0;const{data:e}=await i.get("/students/settings/archived");w.value=Array.isArray(e)?e:[]}catch(e){console.error("Failed to fetch student trash:",e)}finally{m.value=!1}},T=async()=>{try{f.value=!0,console.log("[Trash] fetchInstructorTrash called");const{data:e}=await i.get("/instructors/settings/archived");console.log("[Trash] /instructors/settings/archived response:",e),v.value=Array.isArray(e)?e:[]}catch(e){console.error("Failed to fetch instructor trash:",e)}finally{f.value=!1}},k=async()=>{try{h.value=!0;const{data:e}=await i.get("/ay/archived");C.value=Array.isArray(e)?e:[]}catch(e){console.error("Failed to fetch AY trash:",e)}finally{h.value=!1}},$=async()=>{try{y.value=!0;const{data:e}=await i.get("/curriculums/archived");_.value=Array.isArray(e)?e:[]}catch(e){console.error("Failed to fetch curriculum trash:",e)}finally{y.value=!1}},A=async e=>{if((await o.fire({title:"Restore from Trash?",text:`Restore student ${e.fname} ${e.lname} (ID: ${e.studid})?`,icon:"question",showCancelButton:!0,confirmButtonColor:"#16a34a",cancelButtonColor:"#6b7280",confirmButtonText:"Restore"})).isConfirmed)try{await i.post(`/students/settings/${e.id}/restore`),await B(),o.fire({icon:"success",title:"Restored from Trash",toast:!0,position:"top-end",timer:2e3,showConfirmButton:!1})}catch{o.fire("Error","Could not restore student","error")}},S=async e=>{if((await o.fire({title:"Delete Permanently?",html:`
      <p class="text-sm text-gray-700">
        This will <b>permanently delete</b> student ${e.fname} ${e.lname}
        (ID: ${e.studid}).<br>
        This action cannot be undone.
      </p>
    `,icon:"error",showCancelButton:!0,confirmButtonColor:"#b91c1c",cancelButtonColor:"#6b7280",confirmButtonText:"Delete Permanently"})).isConfirmed)try{await i.delete(`/students/settings/${e.id}/force-delete`),await B(),o.fire({icon:"success",title:"Permanently Deleted",toast:!0,position:"top-end",timer:2e3,showConfirmButton:!1})}catch{o.fire("Error","Could not permanently delete student","error")}},P=async e=>{if((await o.fire({title:"Restore from Trash?",text:`Restore instructor ${e.fname} ${e.lname} (ID: ${e.teachid})?`,icon:"question",showCancelButton:!0,confirmButtonColor:"#16a34a",cancelButtonColor:"#6b7280",confirmButtonText:"Restore"})).isConfirmed)try{await i.post(`/instructors/settings/${e.id}/restore`),await T(),o.fire({icon:"success",title:"Restored from Trash",toast:!0,position:"top-end",timer:2e3,showConfirmButton:!1})}catch{o.fire("Error","Could not restore instructor","error")}},I=async e=>{if((await o.fire({title:"Delete Permanently?",html:`
      <p class="text-sm text-gray-700">
        This will <b>permanently delete</b> instructor ${e.fname} ${e.lname}
        (ID: ${e.teachid}).<br>
        This action cannot be undone.
      </p>
    `,icon:"error",showCancelButton:!0,confirmButtonColor:"#b91c1c",cancelButtonColor:"#6b7280",confirmButtonText:"Delete Permanently"})).isConfirmed)try{await i.delete(`/instructors/settings/${e.id}/force-delete`),await T(),o.fire({icon:"success",title:"Permanently Deleted",toast:!0,position:"top-end",timer:2e3,showConfirmButton:!1})}catch{o.fire("Error","Could not permanently delete instructor","error")}},E=async e=>{if((await o.fire({title:"Restore from Trash?",text:`Restore Academic Year ${e.academicyear} (${e.semester==="1"?"First Semester":e.semester==="2"?"Second Semester":"Summer"}) back to the active list?`,icon:"question",showCancelButton:!0,confirmButtonColor:"#16a34a",cancelButtonColor:"#6b7280",confirmButtonText:"Restore"})).isConfirmed)try{await i.post(`/ay/${e.id}/restore`),await k(),o.fire({icon:"success",title:"Restored from Trash",toast:!0,position:"top-end",timer:2e3,showConfirmButton:!1})}catch{o.fire("Error","Could not restore academic year","error")}},Y=async e=>{if((await o.fire({title:"Delete Permanently?",html:`
      <p class="text-sm text-gray-700">
        This will <b>permanently delete</b> Academic Year ${e.academicyear}.<br>
        This action cannot be undone.
      </p>
    `,icon:"error",showCancelButton:!0,confirmButtonColor:"#b91c1c",cancelButtonColor:"#6b7280",confirmButtonText:"Delete Permanently"})).isConfirmed)try{await i.delete(`/ay/${e.id}/force-delete`),await k(),o.fire({icon:"success",title:"Permanently Deleted",toast:!0,position:"top-end",timer:2e3,showConfirmButton:!1})}catch{o.fire("Error","Could not permanently delete academic year","error")}},j=async e=>{if((await o.fire({title:"Restore from Trash?",text:`Restore Curriculum ${e.curriculum} back to the active list?`,icon:"question",showCancelButton:!0,confirmButtonColor:"#16a34a",cancelButtonColor:"#6b7280",confirmButtonText:"Restore"})).isConfirmed)try{await i.post(`/curriculums/${e.id}/restore`),await $(),o.fire({icon:"success",title:"Restored from Trash",toast:!0,position:"top-end",timer:2e3,showConfirmButton:!1})}catch{o.fire("Error","Could not restore curriculum","error")}},F=async e=>{if((await o.fire({title:"Delete Permanently?",html:`
      <p class="text-sm text-gray-700">
        This will <b>permanently delete</b> Curriculum ${e.curriculum}.<br>
        This action cannot be undone.
      </p>
    `,icon:"error",showCancelButton:!0,confirmButtonColor:"#b91c1c",cancelButtonColor:"#6b7280",confirmButtonText:"Delete Permanently"})).isConfirmed)try{await i.delete(`/curriculums/${e.id}/force-delete`),await $(),o.fire({icon:"success",title:"Permanently Deleted",toast:!0,position:"top-end",timer:2e3,showConfirmButton:!1})}catch{o.fire("Error","Could not permanently delete curriculum","error")}};return L(async()=>{if(await R(),d.value!=="admin"){window.location.href="/";return}B(),T(),k(),$()}),(e,r)=>(n(),N(V,{fullname:g.value,userLevel:d.value,title:"Trash",class:"animate-slide-in-top"},{default:q(()=>[t("div",M,[t("div",z,[r[3]||(r[3]=t("div",{class:"md:flex md:justify-between items-center"},[t("h2",{class:"text-2xl font-semibold mb-2 md:mb-4 ml-2 text-mccblue"}," Students ")],-1)),r[4]||(r[4]=t("hr",{class:"border-t border-gray-300 mb-4"},null,-1)),t("table",G,[r[2]||(r[2]=t("thead",{class:"bg-mccblue text-white"},[t("tr",null,[t("th",{class:"px-4 py-2 w-1/3 text-left"},"Student ID"),t("th",{class:"px-4 py-2 w-1/3 text-left"},"Name"),t("th",{class:"px-4 py-2 w-1/3 text-right"},"Actions")])],-1)),t("tbody",null,[m.value?(n(),a("tr",H,r[0]||(r[0]=[t("td",{colspan:"3",class:"text-center py-4 text-gray-500"}," Loading students... ",-1)]))):(n(!0),a(p,{key:1},b(w.value,s=>(n(),a("tr",{key:s.id,class:"bg-white text-gray-800 border hover:bg-gray-100 transition"},[t("td",J,c(s.studid),1),t("td",K,c(s.fname)+" "+c(s.lname),1),t("td",O,[t("div",Q,[t("button",{onClick:u=>A(s),class:"text-green-600 hover:text-green-800 text-sm font-medium"}," Restore ",8,U),t("button",{onClick:u=>S(s),class:"text-red-600 hover:text-red-800 text-sm font-medium"}," Delete Permanently ",8,W)])])]))),128)),!m.value&&w.value.length===0?(n(),a("tr",X,r[1]||(r[1]=[t("td",{colspan:"3",class:"text-center py-4 text-gray-500"}," No student records in trash. ",-1)]))):x("",!0)])])]),t("div",Z,[r[8]||(r[8]=t("div",{class:"md:flex md:justify-between items-center"},[t("h2",{class:"text-2xl font-semibold mb-2 md:mb-4 ml-2 text-mccblue"}," Instructors ")],-1)),r[9]||(r[9]=t("hr",{class:"border-t border-gray-300 mb-4"},null,-1)),t("table",tt,[r[7]||(r[7]=t("thead",{class:"bg-mccblue text-white"},[t("tr",null,[t("th",{class:"px-4 py-2 w-1/3 text-left"},"Instructor ID"),t("th",{class:"px-4 py-2 w-1/3 text-left"},"Name"),t("th",{class:"px-4 py-2 w-1/3 text-right"},"Actions")])],-1)),t("tbody",null,[f.value?(n(),a("tr",et,r[5]||(r[5]=[t("td",{colspan:"3",class:"text-center py-4 text-gray-500"}," Loading instructors... ",-1)]))):(n(!0),a(p,{key:1},b(v.value,s=>(n(),a("tr",{key:s.id,class:"bg-white text-gray-800 border hover:bg-gray-100 transition"},[t("td",rt,c(s.teachid),1),t("td",st,c(s.fname)+" "+c(s.lname),1),t("td",ot,[t("div",nt,[t("button",{onClick:u=>P(s),class:"text-green-600 hover:text-green-800 text-sm font-medium"}," Restore ",8,at),t("button",{onClick:u=>I(s),class:"text-red-600 hover:text-red-800 text-sm font-medium"}," Delete Permanently ",8,it)])])]))),128)),!f.value&&v.value.length===0?(n(),a("tr",lt,r[6]||(r[6]=[t("td",{colspan:"3",class:"text-center py-4 text-gray-500"}," No instructor records in trash. ",-1)]))):x("",!0)])])]),t("div",ct,[r[13]||(r[13]=t("div",{class:"md:flex md:justify-between items-center"},[t("h2",{class:"text-2xl font-semibold mb-2 md:mb-4 ml-2 text-mccblue"}," Academic Years ")],-1)),r[14]||(r[14]=t("hr",{class:"border-t border-gray-300 mb-4"},null,-1)),t("table",ut,[r[12]||(r[12]=t("thead",{class:"bg-mccblue text-white"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left w-1/3"},"Academic Year"),t("th",{class:"px-4 py-2 text-center w-1/3"},"Semester"),t("th",{class:"px-4 py-2 text-right w-1/3"},"Actions")])],-1)),t("tbody",null,[h.value?(n(),a("tr",dt,r[10]||(r[10]=[t("td",{colspan:"3",class:"text-center py-4 text-gray-500"}," Loading academic years... ",-1)]))):(n(!0),a(p,{key:1},b(C.value,s=>(n(),a("tr",{key:s.id,class:"bg-white text-gray-800 border hover:bg-gray-100 transition"},[t("td",mt,c(s.academicyear),1),t("td",ft,c(s.semester==="1"?"First Semester":s.semester==="2"?"Second Semester":"Summer"),1),t("td",ht,[t("div",yt,[t("button",{onClick:u=>E(s),class:"text-green-600 hover:text-green-800 text-sm font-medium",title:"Restore from Trash"}," Restore ",8,xt),t("button",{onClick:u=>Y(s),class:"text-red-600 hover:text-red-800 text-sm font-medium",title:"Delete Permanently"}," Delete Permanently ",8,pt)])])]))),128)),!h.value&&C.value.length===0?(n(),a("tr",bt,r[11]||(r[11]=[t("td",{colspan:"3",class:"text-center py-4 text-gray-500"}," No academic years in trash. ",-1)]))):x("",!0)])])]),t("div",gt,[r[18]||(r[18]=t("div",{class:"md:flex md:justify-between items-center"},[t("h2",{class:"text-2xl font-semibold mb-2 md:mb-4 ml-2 text-mccblue"}," Curriculums ")],-1)),r[19]||(r[19]=t("hr",{class:"border-t border-gray-300 mb-4"},null,-1)),t("table",wt,[r[17]||(r[17]=t("thead",{class:"bg-mccblue text-white"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left w-2/3"},"Curriculum"),t("th",{class:"px-4 py-2 text-right w-1/3"},"Actions")])],-1)),t("tbody",null,[y.value?(n(),a("tr",vt,r[15]||(r[15]=[t("td",{colspan:"2",class:"text-center py-4 text-gray-500"}," Loading curriculums... ",-1)]))):(n(!0),a(p,{key:1},b(_.value,s=>(n(),a("tr",{key:s.id,class:"bg-white text-gray-800 border hover:bg-gray-100 transition"},[t("td",Ct," Curriculum "+c(s.curriculum),1),t("td",_t,[t("div",Bt,[t("button",{onClick:u=>j(s),class:"text-green-600 hover:text-green-800 text-sm font-medium",title:"Restore from Trash"}," Restore ",8,Tt),t("button",{onClick:u=>F(s),class:"text-red-600 hover:text-red-800 text-sm font-medium",title:"Delete Permanently"}," Delete Permanently ",8,kt)])])]))),128)),!y.value&&_.value.length===0?(n(),a("tr",$t,r[16]||(r[16]=[t("td",{colspan:"2",class:"text-center py-4 text-gray-500"}," No curriculums in trash. ",-1)]))):x("",!0)])])])])]),_:1},8,["fullname","userLevel"]))}};export{Pt as default};
