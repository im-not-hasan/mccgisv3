# ===============================================================
# Laravel Root .htaccess â€” Secure + Hostinger Compatible
# ===============================================================

<IfModule mod_rewrite.c>
  RewriteEngine On

  # ğŸš« Block direct access to /public folder
  RewriteCond %{REQUEST_URI} ^/public(/|$)
  RewriteRule .* - [F,L]

  # ğŸš« Block manual requests containing "/public" in the URL
  RewriteCond %{THE_REQUEST} "\s/public([/?#\s]|$)" [NC]
  RewriteRule ^ - [R=403,L]

  # ğŸš« Block direct access to index.php in root
  RewriteCond %{THE_REQUEST} "^[A-Z]{3,}\s/+index\.php[?\s]" [NC]
  RewriteRule ^index\.php$ - [R=403,L]

  # âœ… Ensure the request is not already pointing to /public
  RewriteCond %{REQUEST_URI} !^/public/
  # Redirect everything else into /public
  RewriteRule ^(.*)$ public/$1 [L]
</IfModule>


# ===============================================================
# ğŸ§± Force deny specific files (case-insensitive)
# ===============================================================
<FilesMatch "(?i)^(logo\.png|header\.png|watermark\.png)$">
    Require all denied
</FilesMatch>

# ğŸ”§ Optional: prevent browser cache issues during testing
<IfModule mod_headers.c>
    Header set Cache-Control "no-store, no-cache, must-revalidate, max-age=0"
</IfModule>


# ===============================================================
# ğŸ”’ Security Hardening
# ===============================================================

# Block sensitive files
RedirectMatch 404 /\.(env|git|ht|DS_Store)
RedirectMatch 404 /\.env\..*
RedirectMatch 404 ^/(storage|vendor|bootstrap|resources|config)/.*

# Disable directory browsing
Options -Indexes


# ===============================================================
# ğŸ›¡ï¸ Security Headers
# ===============================================================
<IfModule mod_headers.c>
  Header always set X-XSS-Protection "1; mode=block"
  Header always set X-Content-Type-Options "nosniff"
  Header always set Referrer-Policy "no-referrer"
  Header always set X-Frame-Options "SAMEORIGIN"
  Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
  Header always set Permissions-Policy "geolocation=(), microphone=(), camera=(), fullscreen=(self)"
</IfModule>
