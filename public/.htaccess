# ===============================================================
# Laravel Root .htaccess ‚Äî Secure + Hostinger Compatible (Safe)
# ===============================================================

<IfModule mod_rewrite.c>
  RewriteEngine On

  # üö´ Block direct /public access (typed manually in browser)
  RewriteCond %{THE_REQUEST} "\s/public([/?#\s]|$)" [NC]
  RewriteRule ^ - [R=403,L]

  # üö´ Block direct /index.php access (typed manually)
  RewriteCond %{THE_REQUEST} "^[A-Z]{3,}\s/+index\.php[?\s]" [NC]
  RewriteRule ^index\.php$ - [R=403,L]

  # ‚úÖ Redirect everything else INTO /public (but not twice)
  RewriteCond %{REQUEST_URI} !^/public/
  RewriteRule ^(.*)$ public/$1 [L]
</IfModule>


# ===============================================================
# üß± Deny specific sensitive image files
# ===============================================================
<FilesMatch "(?i)^(logo\.png|header\.png|watermark\.png)$">
    Require all denied
</FilesMatch>

# ===============================================================
# üîí Security Hardening
# ===============================================================
RedirectMatch 404 /\.(env|git|ht|DS_Store)
RedirectMatch 404 /\.env\..*
RedirectMatch 404 ^/(storage|vendor|bootstrap|resources|config)/.*

Options -Indexes

# ===============================================================
# üõ°Ô∏è Security Headers
# ===============================================================
<IfModule mod_headers.c>
  Header always set X-XSS-Protection "1; mode=block"
  Header always set X-Content-Type-Options "nosniff"
  Header always set Referrer-Policy "no-referrer"
  Header always set X-Frame-Options "SAMEORIGIN"
  Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
  Header always set Permissions-Policy "geolocation=(), microphone=(), camera=(), fullscreen=(self)"
</IfModule>
