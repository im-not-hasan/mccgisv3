# ===============================================================
# Laravel Root .htaccess â€” Secure + Works on Shared Hosts (Hostinger)
# ===============================================================

<IfModule mod_rewrite.c>
  RewriteEngine On

  # Ensure the request is not already pointing to /public
  RewriteCond %{REQUEST_URI} !^/public/
  # Redirect everything into /public
  RewriteRule ^(.*)$ public/$1 [L]
</IfModule>


# ===============================================================
# Security Hardening
# ===============================================================

# ðŸ”’ Deny access to hidden files (.env, .git, etc.)
RedirectMatch 404 /\.(.*)$

# ðŸ”’ Block sensitive Laravel core files
<FilesMatch "(artisan|server\.php|composer\.(json|lock)|package\.json|webpack\.mix\.js)$">
    Require all denied
</FilesMatch>

# ðŸ”’ Block storage and vendor folder access
RedirectMatch 404 ^/(storage|vendor)/.*

# ðŸ”’ Disable directory browsing
Options -Indexes


# ===============================================================
# Security Headers (Enhanced and Scan-Ready)
# ===============================================================
<IfModule mod_headers.c>
    # Basic protections
    Header always set X-XSS-Protection "1; mode=block"
    Header always set X-Content-Type-Options "nosniff"
    Header always set Referrer-Policy "no-referrer"
    Header always set X-Frame-Options "SAMEORIGIN"

    # âœ… Add Strict Transport Security (HSTS)
    # Enforces HTTPS for one year across all subdomains
    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"

    # âœ… Add Permissions Policy
    # Controls what browser features your site can use
    Header always set Permissions-Policy "geolocation=(), microphone=(), camera=(), fullscreen=(self)"

    # Optional: Content Security Policy (kept mild for compatibility)
    # Header always set Content-Security-Policy "default-src 'self' 'unsafe-inline' https://www.google.com/recaptcha/ https://www.gstatic.com/;"
</IfModule>
