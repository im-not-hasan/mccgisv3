# ===============================================================
# Laravel Root .htaccess â€” Secure + Hostinger Compatible
# ===============================================================

<IfModule mod_rewrite.c>
  RewriteEngine On

  # ðŸš« HARD BLOCK: If someone tries to open /public directly
  RewriteCond %{THE_REQUEST} "\s/public([/?#\s]|$)" [NC]
  RewriteRule ^public - [R=403,L]

  # âœ… Normal rewrite for everything else
  RewriteCond %{REQUEST_URI} !^/public/
  RewriteRule ^(.*)$ public/$1 [L]
</IfModule>

# ===============================================================
# Security Hardening
# ===============================================================

# ðŸ”’ Block hidden/system files (.env, .git, etc.)
RedirectMatch 404 /\.env
RedirectMatch 404 /\.git
RedirectMatch 404 /\.ht
RedirectMatch 404 /\.env\..*

# ðŸ”’ Block Laravel core / vendor / storage
RedirectMatch 404 ^/(storage|vendor|bootstrap|resources|config)/.*

# ðŸ”’ Disable directory browsing
Options -Indexes

# ===============================================================
# Security Headers
# ===============================================================
<IfModule mod_headers.c>
    Header always set X-XSS-Protection "1; mode=block"
    Header always set X-Content-Type-Options "nosniff"
    Header always set Referrer-Policy "no-referrer"
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    Header always set Permissions-Policy "geolocation=(), microphone=(), camera=(), fullscreen=(self)"
</IfModule>
